<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BeanGen.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Joda-Beans</a> &gt; <a href="index.source.html" class="el_package">org.joda.beans.gen</a> &gt; <span class="el_source">BeanGen.java</span></div><h1>BeanGen.java</h1><pre class="source lang-java linenums">/*
 *  Copyright 2001-present Stephen Colebourne
 *
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
package org.joda.beans.gen;

import java.io.File;
import java.lang.invoke.MethodHandles;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.ListIterator;
import java.util.Map;
import java.util.NoSuchElementException;
import java.util.Set;
import java.util.SortedSet;
import java.util.TreeSet;
import java.util.function.BiConsumer;
import java.util.function.Function;

import org.joda.beans.Bean;
import org.joda.beans.BeanBuilder;
import org.joda.beans.JodaBeanUtils;
import org.joda.beans.MetaBean;
import org.joda.beans.MetaProperty;
import org.joda.beans.TypedMetaBean;
import org.joda.beans.impl.BasicBeanBuilder;
import org.joda.beans.impl.direct.DirectBean;
import org.joda.beans.impl.direct.DirectBeanBuilder;
import org.joda.beans.impl.direct.DirectFieldsBeanBuilder;
import org.joda.beans.impl.direct.DirectMetaBean;
import org.joda.beans.impl.direct.DirectMetaPropertyMap;
import org.joda.beans.impl.direct.DirectPrivateBeanBuilder;
import org.joda.beans.impl.direct.MinimalMetaBean;
import org.joda.beans.impl.light.LightMetaBean;

/**
 * Code generator for a bean.
 * 
 * @author Stephen Colebourne
 */
class BeanGen {

    /** Constructor style for none. */
    static final int CONSTRUCTOR_NONE = 0;
    /** Constructor style for builder-based. */
    static final int CONSTRUCTOR_BY_BUILDER = 1;
    /** Constructor style for argument-based. */
    static final int CONSTRUCTOR_BY_ARGS = 2;
    /** Class constant, avoiding module dependency in Java 9. */
    private static final Class&lt;?&gt; CLASS_CONSTRUCTOR_PROPERTIES;
    /** Class constant, avoiding module dependency in Java 9. */
    private static final Class&lt;?&gt; CLASS_PROPERTY_CHANGE_SUPPORT;
    static {
<span class="nc" id="L68">        Class&lt;?&gt; cls1 = null;</span>
<span class="nc" id="L69">        Class&lt;?&gt; cls2 = null;</span>
        try {
<span class="nc" id="L71">            cls1 = Class.forName(&quot;java.beans.ConstructorProperties&quot;);</span>
<span class="nc" id="L72">            cls2 = Class.forName(&quot;java.beans.PropertyChangeSupport&quot;);</span>
<span class="nc" id="L73">        } catch (ClassNotFoundException ex) {</span>
            // ignore
<span class="nc" id="L75">        }</span>
<span class="nc" id="L76">        CLASS_CONSTRUCTOR_PROPERTIES = cls1;</span>
<span class="nc" id="L77">        CLASS_PROPERTY_CHANGE_SUPPORT = cls2;</span>
    }
    /** Line separator. */
    private static final String LINE_SEPARATOR = &quot;\t//-----------------------------------------------------------------------&quot;;
    /** Line separator. */
    private static final String LINE_SEPARATOR_INDENTED = &quot;\t\t//-----------------------------------------------------------------------&quot;;
    /** Types with primitive equals. */
<span class="nc" id="L84">    private static final Set&lt;String&gt; PRIMITIVE_EQUALS = new HashSet&lt;&gt;();</span>
    static {
<span class="nc" id="L86">        PRIMITIVE_EQUALS.add(&quot;boolean&quot;);</span>
<span class="nc" id="L87">        PRIMITIVE_EQUALS.add(&quot;char&quot;);</span>
<span class="nc" id="L88">        PRIMITIVE_EQUALS.add(&quot;byte&quot;);</span>
<span class="nc" id="L89">        PRIMITIVE_EQUALS.add(&quot;short&quot;);</span>
<span class="nc" id="L90">        PRIMITIVE_EQUALS.add(&quot;int&quot;);</span>
<span class="nc" id="L91">        PRIMITIVE_EQUALS.add(&quot;long&quot;);</span>
        // not float or double, as Double.equals is not the same as double ==
<span class="nc" id="L93">    }</span>

    /** The content to process. */
    private final File file;
    /** The content to process. */
    private final List&lt;String&gt; content;
    /** The config. */
    private final BeanGenConfig config;
    /** The data model of the bean. */
    private final BeanData data;
    /** The list of property generators. */
    private final List&lt;PropertyGen&gt; properties;
    /** The region to insert into. */
    private final List&lt;String&gt; insertRegion;
    /** The list of removed imports. */
<span class="nc" id="L108">    private final SortedSet&lt;String&gt; removedImports = new TreeSet&lt;&gt;();</span>

    /**
     * Constructor used when file is not a bean.
     * @param file  the file, not null
     * @param content  the content to process, not null
     * @param config  the config to use, not null
     * @param data  the parsed data
     */
<span class="nc" id="L117">    BeanGen(File file, List&lt;String&gt; content, BeanGenConfig config, BeanData data) {</span>
<span class="nc" id="L118">        this.file = file;</span>
<span class="nc" id="L119">        this.content = content;</span>
<span class="nc" id="L120">        this.config = config;</span>
<span class="nc" id="L121">        this.data = data;</span>
<span class="nc" id="L122">        this.properties = null;</span>
<span class="nc" id="L123">        this.insertRegion = null;</span>
<span class="nc" id="L124">    }</span>

    /**
     * Constructor used when file is a parsed bean.
     * @param file  the file, not null
     * @param content  the content to process, not null
     * @param config  the config to use, not null
     * @param data  the parsed data
     * @param properties  the parsed properties
     * @param autoEndIndex  the start of the autogen area
     * @param autoStartIndex   the end of the autogen area
     */
    BeanGen(
            File file, List&lt;String&gt; content, BeanGenConfig config,
<span class="nc" id="L138">            BeanData data, List&lt;PropertyGen&gt; properties, int autoStartIndex, int autoEndIndex) {</span>
<span class="nc" id="L139">        this.file = file;</span>
<span class="nc" id="L140">        this.content = content;</span>
<span class="nc" id="L141">        this.config = config;</span>
<span class="nc" id="L142">        this.data = data;</span>
<span class="nc" id="L143">        this.properties = properties;</span>
<span class="nc" id="L144">        this.insertRegion = content.subList(autoStartIndex + 1, autoEndIndex);</span>
<span class="nc" id="L145">    }</span>

    //-----------------------------------------------------------------------
    void process() {
<span class="nc" id="L149">        fixImports();</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">        if (insertRegion != null) {</span>
<span class="nc" id="L151">            data.ensureImport(BeanDefinition.class);</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">            if (properties.size() &gt; 0) {</span>
<span class="nc" id="L153">                data.ensureImport(PropertyDefinition.class);</span>
            }
<span class="nc" id="L155">            removeOld();</span>
<span class="nc bnc" id="L156" title="All 4 branches missed.">            if (data.isRootClass() &amp;&amp; data.isExtendsDirectBean()) {</span>
<span class="nc" id="L157">                data.ensureImport(DirectBean.class);</span>
            }
<span class="nc" id="L159">            generateMeta();</span>
<span class="nc" id="L160">            generateSerializationVersionId();</span>
<span class="nc" id="L161">            generatePropertyChangeSupportField();</span>
<span class="nc" id="L162">            generateHashCodeField();</span>
<span class="nc" id="L163">            generateFactory();</span>
<span class="nc" id="L164">            generateImmutableBuilderMethod();</span>
<span class="nc" id="L165">            generateArgBasedConstructor();</span>
<span class="nc" id="L166">            generateBuilderBasedConstructor();</span>
<span class="nc" id="L167">            generateMetaBean();</span>
<span class="nc" id="L168">            generateGettersSetters();</span>
<span class="nc" id="L169">            generateSeparator();</span>
<span class="nc" id="L170">            generateImmutableToBuilder();</span>
<span class="nc" id="L171">            generateClone();</span>
<span class="nc" id="L172">            generateEquals();</span>
<span class="nc" id="L173">            generateHashCode();</span>
<span class="nc" id="L174">            generateToString();</span>
<span class="nc" id="L175">            generateMetaClass();</span>
<span class="nc" id="L176">            generateBuilderClass();</span>
<span class="nc" id="L177">            resolveImports();</span>
<span class="nc" id="L178">            resolveIndents();</span>
        }
<span class="nc" id="L180">    }</span>

    void processNonBean() {
<span class="nc" id="L183">        fixImports();</span>
<span class="nc" id="L184">        resolveImports();</span>
<span class="nc" id="L185">    }</span>

    private void fixImports() {
<span class="nc" id="L188">        renameImport(&quot;org.joda.beans.BeanDefinition&quot;, BeanDefinition.class);</span>
<span class="nc" id="L189">        renameImport(&quot;org.joda.beans.DerivedProperty&quot;, DerivedProperty.class);</span>
<span class="nc" id="L190">        renameImport(&quot;org.joda.beans.ImmutableConstructor&quot;, ImmutableConstructor.class);</span>
<span class="nc" id="L191">        renameImport(&quot;org.joda.beans.ImmutableDefaults&quot;, ImmutableDefaults.class);</span>
<span class="nc" id="L192">        renameImport(&quot;org.joda.beans.ImmutablePreBuild&quot;, ImmutablePreBuild.class);</span>
<span class="nc" id="L193">        renameImport(&quot;org.joda.beans.ImmutableValidator&quot;, ImmutableValidator.class);</span>
<span class="nc" id="L194">        renameImport(&quot;org.joda.beans.PropertyDefinition&quot;, PropertyDefinition.class);</span>
<span class="nc" id="L195">    }</span>

    private void renameImport(String old, Class&lt;?&gt; cls) {
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (data.getCurrentImports().contains(old)) {</span>
<span class="nc" id="L199">            removedImports.add(old);</span>
<span class="nc" id="L200">            data.ensureImport(cls);</span>
        }
<span class="nc" id="L202">    }</span>

    private void resolveImports() {
<span class="nc bnc" id="L205" title="All 2 branches missed.">        if (data.getNewImports().size() &gt; 0) {</span>
<span class="nc" id="L206">            int pos = data.getImportInsertLocation() + 1;</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">            for (String imp : data.getNewImports()) {</span>
<span class="nc" id="L208">                content.add(pos++, &quot;import &quot; + imp + &quot;;&quot;);</span>
<span class="nc" id="L209">            }</span>
        }
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (removedImports.size() &gt; 0) {</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">            for (ListIterator&lt;String&gt; it = content.listIterator(); it.hasNext(); ) {</span>
<span class="nc" id="L213">                String line = it.next().trim();</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">                if (line.startsWith(&quot;import &quot;)) {</span>
<span class="nc" id="L215">                    String imported = line.substring(7).trim().replace(&quot; &quot;, &quot;&quot;).replace(&quot;;&quot;, &quot;&quot;);</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">                    if (removedImports.contains(imported)) {</span>
<span class="nc" id="L217">                        it.remove();</span>
                    }
                }
<span class="nc" id="L220">            }</span>
        }
<span class="nc" id="L222">    }</span>

    private void resolveIndents() {
<span class="nc bnc" id="L225" title="All 2 branches missed.">        for (ListIterator&lt;String&gt; it = content.listIterator(); it.hasNext(); ) {</span>
<span class="nc" id="L226">            it.set(it.next().replace(&quot;\t&quot;, config.getIndent()));</span>
        }
<span class="nc" id="L228">    }</span>

    private void removeOld() {
<span class="nc" id="L231">        insertRegion.clear();</span>
<span class="nc" id="L232">    }</span>

    //-----------------------------------------------------------------------
    private void generateSeparator() {
<span class="nc bnc" id="L236" title="All 4 branches missed.">        if (insertRegion.size() &gt; 0 &amp;&amp; insertRegion.get(insertRegion.size() - 1).equals(LINE_SEPARATOR)) {</span>
<span class="nc" id="L237">            return;</span>
        }
<span class="nc" id="L239">        insertRegion.add(LINE_SEPARATOR);</span>
<span class="nc" id="L240">    }</span>

    private void generateIndentedSeparator() {
<span class="nc bnc" id="L243" title="All 4 branches missed.">        if (insertRegion.size() &gt; 0 &amp;&amp; insertRegion.get(insertRegion.size() - 1).equals(LINE_SEPARATOR_INDENTED)) {</span>
<span class="nc" id="L244">            return;</span>
        }
<span class="nc" id="L246">        insertRegion.add(LINE_SEPARATOR_INDENTED);</span>
<span class="nc" id="L247">    }</span>

    private void generateFactory() {
<span class="nc bnc" id="L250" title="All 2 branches missed.">        if (data.isFactoryRequired()) {</span>
<span class="nc" id="L251">            List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc" id="L252">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L253">            insertRegion.add(&quot;\t * Obtains an instance.&quot;);</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">            if (nonDerived.size() &gt; 0) {</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">                if (data.isTypeGeneric()) {</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">                    for (int j = 0; j &lt; data.getTypeGenericCount(); j++) {</span>
<span class="nc" id="L257">                        insertRegion.add(&quot;\t * @param &quot; + data.getTypeGenericName(j, true) + &quot;  the type&quot;);</span>
                    }
                }
<span class="nc bnc" id="L260" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L261">                    PropertyData prop = nonDerived.get(i).getData();</span>
<span class="nc" id="L262">                    insertRegion.add(&quot;\t * @param &quot; + prop.getPropertyName() + &quot;  the value of the property&quot; + prop.getNotNullJavadoc());</span>
                }
            }
<span class="nc" id="L265">            insertRegion.add(&quot;\t * @return the instance&quot;);</span>
<span class="nc" id="L266">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc bnc" id="L267" title="All 2 branches missed.">            if (nonDerived.isEmpty()) {</span>
<span class="nc" id="L268">                insertRegion.add(&quot;\tpublic static &quot; + data.getTypeNoExtends() + &quot; &quot; + data.getFactoryName() + &quot;() {&quot;);</span>
<span class="nc" id="L269">                insertRegion.add(&quot;\t\treturn new &quot; + data.getTypeNoExtends() + &quot;();&quot;);</span>
                
            } else {
<span class="nc bnc" id="L272" title="All 2 branches missed.">                if (data.isTypeGeneric()) {</span>
<span class="nc" id="L273">                    insertRegion.add(&quot;\tpublic static &quot; + data.getTypeGeneric(true) + &quot; &quot; +</span>
<span class="nc" id="L274">                                    data.getTypeNoExtends() + &quot; &quot; + data.getFactoryName() + &quot;(&quot;);</span>
                } else {
<span class="nc" id="L276">                    insertRegion.add(&quot;\tpublic static &quot; + data.getTypeNoExtends() + &quot; &quot; + data.getFactoryName() + &quot;(&quot;);</span>
                }
<span class="nc bnc" id="L278" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L279">                    PropertyGen prop = nonDerived.get(i);</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">                    insertRegion.add(&quot;\t\t\t&quot; + prop.getBuilderType() + &quot; &quot; + prop.getData().getPropertyName() + (i &lt; nonDerived.size() - 1 ? &quot;,&quot; : &quot;) {&quot;));</span>
                }
<span class="nc" id="L282">                insertRegion.add(&quot;\t\treturn new &quot; + data.getTypeWithDiamond() + &quot;(&quot;);</span>
<span class="nc bnc" id="L283" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L284" title="All 2 branches missed.">                    insertRegion.add(&quot;\t\t\t&quot; + nonDerived.get(i).generateBuilderFieldName() + (i &lt; nonDerived.size() - 1 ? &quot;,&quot; : &quot;);&quot;));</span>
                }
            }
<span class="nc" id="L287">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L288">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L290">    }</span>

    private void generateImmutableBuilderMethod() {
<span class="nc bnc" id="L293" title="All 2 branches missed.">        if (data.isConstructable() &amp;&amp;</span>
<span class="nc bnc" id="L294" title="All 8 branches missed.">                ((data.isImmutable() &amp;&amp; data.isEffectiveBuilderScopeVisible()) || (data.isMutable() &amp;&amp; data.isBuilderScopeVisible()))) {</span>
<span class="nc" id="L295">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L296">            insertRegion.add(&quot;\t * Returns a builder used to create an instance of the bean.&quot;);</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">                for (int j = 0; j &lt; data.getTypeGenericCount(); j++) {</span>
<span class="nc" id="L299">                    insertRegion.add(&quot;\t * @param &quot; + data.getTypeGenericName(j, true) + &quot;  the type&quot;);</span>
                }
            }
<span class="nc" id="L302">            insertRegion.add(&quot;\t * @return the builder, not null&quot;);</span>
<span class="nc" id="L303">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc bnc" id="L304" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc" id="L305">                insertRegion.add(&quot;\t&quot; + data.getEffectiveBuilderScope() + &quot;static &quot; + data.getTypeGeneric(true) +</span>
<span class="nc" id="L306">                                &quot; &quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericName(true) + &quot; builder() {&quot;);</span>
            } else {
<span class="nc" id="L308">                insertRegion.add(&quot;\t&quot; + data.getEffectiveBuilderScope() + &quot;static &quot; + data.getTypeRaw() + &quot;.Builder builder() {&quot;);</span>
            }
<span class="nc" id="L310">            insertRegion.add(&quot;\t\treturn new &quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericDiamond() + &quot;();&quot;);</span>
<span class="nc" id="L311">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L312">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L314">    }</span>

    private void generateBuilderBasedConstructor() {
<span class="nc bnc" id="L317" title="All 4 branches missed.">        if (data.getConstructorStyle() == CONSTRUCTOR_BY_BUILDER &amp;&amp; data.getImmutableConstructor() == CONSTRUCTOR_NONE &amp;&amp; </span>
<span class="nc bnc" id="L318" title="All 6 branches missed.">                ((data.isMutable() &amp;&amp; data.isBuilderScopeVisible()) || data.isImmutable())) {</span>
<span class="nc" id="L319">            List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc bnc" id="L320" title="All 2 branches missed.">            String scope = (data.isTypeFinal() ? &quot;private&quot; : &quot;protected&quot;);</span>
            // signature
<span class="nc" id="L322">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L323">            insertRegion.add(&quot;\t * Restricted constructor.&quot;);</span>
<span class="nc" id="L324">            insertRegion.add(&quot;\t * @param builder  the builder to copy from, not null&quot;);</span>
<span class="nc" id="L325">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L326">            insertRegion.add(&quot;\t&quot; + scope + &quot; &quot; + data.getTypeRaw() + &quot;(&quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericName(true) + &quot; builder) {&quot;);</span>
            // super
<span class="nc bnc" id="L328" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L329">                insertRegion.add(&quot;\t\tsuper(builder);&quot;);</span>
            }
            // validate
<span class="nc bnc" id="L332" title="All 2 branches missed.">            for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">                if (prop.getData().isValidated()) {</span>
<span class="nc" id="L334">                    insertRegion.add(&quot;\t\t&quot; + prop.getData().getValidationMethodName() +</span>
<span class="nc" id="L335">                            &quot;(builder.&quot; + prop.generateBuilderFieldName() +</span>
<span class="nc" id="L336">                            &quot;, \&quot;&quot; + prop.getData().getPropertyName() + &quot;\&quot;);&quot;);</span>
                }
<span class="nc" id="L338">            }</span>
            // assign
<span class="nc bnc" id="L340" title="All 2 branches missed.">            if (data.isImmutable()) {</span>
                // assign
<span class="nc bnc" id="L342" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L343">                    insertRegion.addAll(nonDerived.get(i).generateConstructorAssign(&quot;builder.&quot;));</span>
                }
            } else {
<span class="nc bnc" id="L346" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L347">                    PropertyGen propGen = nonDerived.get(i);</span>
<span class="nc" id="L348">                    PropertyData prop = propGen.getData();</span>
<span class="nc bnc" id="L349" title="All 2 branches missed.">                    if (prop.isCollectionType()) {</span>
<span class="nc bnc" id="L350" title="All 2 branches missed.">                        if (prop.isNotNull()) {</span>
<span class="nc" id="L351">                            insertRegion.add(&quot;\t\tthis.&quot; + prop.getPropertyName() + &quot;.addAll(builder.&quot; + propGen.generateBuilderFieldName() + &quot;);&quot;);</span>
                        } else {
<span class="nc" id="L353">                            insertRegion.add(&quot;\t\tthis.&quot; + prop.getPropertyName() + &quot; = builder.&quot; + propGen.generateBuilderFieldName() + &quot;;&quot;);</span>
                        }
<span class="nc bnc" id="L355" title="All 2 branches missed.">                    } else if (prop.isMapType()) {</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">                        if (prop.isNotNull()) {</span>
<span class="nc" id="L357">                            insertRegion.add(&quot;\t\tthis.&quot; + prop.getPropertyName() + &quot;.putAll(builder.&quot; + propGen.generateBuilderFieldName() + &quot;);&quot;);</span>
                        } else {
<span class="nc" id="L359">                            insertRegion.add(&quot;\t\tthis.&quot; + prop.getPropertyName() + &quot; = builder.&quot; + propGen.generateBuilderFieldName() + &quot;;&quot;);</span>
                        }
                    } else {
<span class="nc" id="L362">                        insertRegion.add(&quot;\t\tthis.&quot; + prop.getPropertyName() + &quot; = builder.&quot; + propGen.generateBuilderFieldName() + &quot;;&quot;);</span>
                    }
                }
            }
<span class="nc bnc" id="L366" title="All 2 branches missed.">            if (data.getImmutableValidator() != null) {</span>
<span class="nc" id="L367">                insertRegion.add(&quot;\t\t&quot; + data.getImmutableValidator() + &quot;();&quot;);</span>
            }
<span class="nc" id="L369">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L370">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L372">    }</span>

    private void generateArgBasedConstructor() {
<span class="nc bnc" id="L375" title="All 4 branches missed.">        if (data.getConstructorStyle() == CONSTRUCTOR_BY_ARGS &amp;&amp; data.getImmutableConstructor() == CONSTRUCTOR_NONE &amp;&amp; </span>
<span class="nc bnc" id="L376" title="All 8 branches missed.">                ((data.isMutable() &amp;&amp; (data.isBuilderScopeVisible() || data.isBeanStyleLight())) || data.isImmutable())) {</span>
<span class="nc" id="L377">            String scope = data.getEffectiveConstructorScope();</span>
<span class="nc" id="L378">            boolean generateAnnotation = data.isConstructorPropertiesAnnotation();</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">            boolean generateJavadoc = !&quot;private &quot;.equals(scope);</span>
<span class="nc" id="L380">            List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc bnc" id="L381" title="All 2 branches missed.">            if (nonDerived.size() == 0) {</span>
<span class="nc bnc" id="L382" title="All 2 branches missed.">                if (generateJavadoc) {</span>
<span class="nc" id="L383">                    insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L384">                    insertRegion.add(&quot;\t * Creates an instance.&quot;);</span>
<span class="nc" id="L385">                    insertRegion.add(&quot;\t */&quot;);</span>
                }
<span class="nc bnc" id="L387" title="All 2 branches missed.">                if (generateAnnotation) {</span>
<span class="nc" id="L388">                    data.ensureImport(CLASS_CONSTRUCTOR_PROPERTIES);</span>
<span class="nc" id="L389">                    insertRegion.add(&quot;\t@ConstructorProperties({})&quot;);</span>
                }
<span class="nc" id="L391">                insertRegion.add(&quot;\t&quot; + scope + data.getTypeRaw() + &quot;() {&quot;);</span>
            } else {
                // signature
<span class="nc bnc" id="L394" title="All 2 branches missed.">                if (generateJavadoc) {</span>
<span class="nc" id="L395">                    insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L396">                    insertRegion.add(&quot;\t * Creates an instance.&quot;);</span>
<span class="nc bnc" id="L397" title="All 2 branches missed.">                    for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L398">                        PropertyData prop = nonDerived.get(i).getData();</span>
<span class="nc" id="L399">                        insertRegion.add(&quot;\t * @param &quot; + prop.getPropertyName() + &quot;  the value of the property&quot; + prop.getNotNullJavadoc());</span>
                    }
<span class="nc" id="L401">                    insertRegion.add(&quot;\t */&quot;);</span>
                }
<span class="nc bnc" id="L403" title="All 2 branches missed.">                if (generateAnnotation) {</span>
<span class="nc" id="L404">                    data.ensureImport(CLASS_CONSTRUCTOR_PROPERTIES);</span>
<span class="nc" id="L405">                    StringBuilder buf = new StringBuilder();</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">                    for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L407" title="All 2 branches missed.">                        if (i &gt; 0) {</span>
<span class="nc" id="L408">                            buf.append(&quot;, &quot;);</span>
                        }
<span class="nc" id="L410">                        buf.append('&quot;').append(nonDerived.get(i).getData().getPropertyName()).append('&quot;');</span>
                    }
<span class="nc" id="L412">                    insertRegion.add(&quot;\t@ConstructorProperties({&quot; + buf.toString() + &quot;})&quot;);</span>
                }
<span class="nc" id="L414">                insertRegion.add(&quot;\t&quot; + scope + data.getTypeRaw() + &quot;(&quot;);</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L416">                    PropertyGen prop = nonDerived.get(i);</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">                    insertRegion.add(&quot;\t\t\t&quot; + prop.getBuilderType() + &quot; &quot; + prop.getData().getPropertyName() + (i &lt; nonDerived.size() - 1 ? &quot;,&quot; : &quot;) {&quot;));</span>
                }
                // validate (mutable light beans call setters which validate)
<span class="nc bnc" id="L420" title="All 4 branches missed.">                if (!(data.isMutable() &amp;&amp; data.isBeanStyleLight())) {</span>
<span class="nc bnc" id="L421" title="All 2 branches missed.">                    for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L422" title="All 2 branches missed.">                        if (prop.getData().isValidated()) {</span>
<span class="nc" id="L423">                            insertRegion.add(&quot;\t\t&quot; + prop.getData().getValidationMethodName() +</span>
<span class="nc" id="L424">                                    &quot;(&quot; + prop.getData().getPropertyName() +</span>
<span class="nc" id="L425">                                    &quot;, \&quot;&quot; + prop.getData().getPropertyName() + &quot;\&quot;);&quot;);</span>
                        }
<span class="nc" id="L427">                    }</span>
                }
                // assign
<span class="nc bnc" id="L430" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L431">                    PropertyGen prop = nonDerived.get(i);</span>
<span class="nc bnc" id="L432" title="All 4 branches missed.">                    if (data.isMutable() &amp;&amp; data.isBeanStyleLight()) {</span>
<span class="nc" id="L433">                        String generateSetInvoke = prop.getData().getSetterGen().generateSetInvoke(</span>
<span class="nc" id="L434">                                prop.getData(), prop.getData().getPropertyName());</span>
<span class="nc" id="L435">                        insertRegion.add(&quot;\t\t&quot; + generateSetInvoke + &quot;;&quot;);</span>
<span class="nc" id="L436">                    } else {</span>
<span class="nc" id="L437">                        insertRegion.addAll(prop.generateConstructorAssign(&quot;&quot;));</span>
                    }
                }
            }
<span class="nc bnc" id="L441" title="All 2 branches missed.">            if (data.getImmutableValidator() != null) {</span>
<span class="nc" id="L442">                insertRegion.add(&quot;\t\t&quot; + data.getImmutableValidator() + &quot;();&quot;);</span>
            }
<span class="nc" id="L444">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L445">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L447">    }</span>

    //-----------------------------------------------------------------------
    private void generateMeta() {
<span class="nc bnc" id="L451" title="All 2 branches missed.">        if (data.isBeanStyleLightOrMinimal()) {</span>
<span class="nc" id="L452">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L453">            insertRegion.add(&quot;\t * The meta-bean for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc" id="L454">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L455">            boolean genericProps = data.getProperties().stream()</span>
<span class="nc" id="L456">                    .filter(p -&gt; p.isGeneric())</span>
<span class="nc" id="L457">                    .findAny()</span>
<span class="nc" id="L458">                    .isPresent();</span>
<span class="nc bnc" id="L459" title="All 6 branches missed.">            boolean unchecked = data.isBeanStyleMinimal() &amp;&amp; data.isMutable() &amp;&amp; genericProps;</span>
<span class="nc bnc" id="L460" title="All 6 branches missed.">            unchecked |= data.isBeanStyleMinimal() &amp;&amp; data.isTypeGeneric() &amp;&amp; !data.isSkipBuilderGeneration();</span>
<span class="nc bnc" id="L461" title="All 4 branches missed.">            boolean rawtypes = data.isBeanStyleMinimal() &amp;&amp; data.isTypeGeneric();</span>
<span class="nc bnc" id="L462" title="All 4 branches missed.">            if (unchecked &amp;&amp; rawtypes) {</span>
<span class="nc" id="L463">                insertRegion.add(&quot;\t@SuppressWarnings({\&quot;unchecked\&quot;, \&quot;rawtypes\&quot; })&quot;);</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">            } else if (rawtypes) {</span>
<span class="nc" id="L465">                insertRegion.add(&quot;\t@SuppressWarnings(\&quot;rawtypes\&quot;)&quot;);</span>
<span class="nc bnc" id="L466" title="All 2 branches missed.">            } else if (unchecked) {</span>
<span class="nc" id="L467">                insertRegion.add(&quot;\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
            }
<span class="nc bnc" id="L469" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc" id="L470">                data.ensureImport(MetaBean.class);</span>
<span class="nc" id="L471">                insertRegion.add(&quot;\tprivate static final MetaBean META_BEAN =&quot;);</span>
            } else {
<span class="nc" id="L473">                data.ensureImport(TypedMetaBean.class);</span>
<span class="nc" id="L474">                insertRegion.add(&quot;\tprivate static final TypedMetaBean&lt;&quot; + data.getTypeNoExtends() + &quot;&gt; META_BEAN =&quot;);</span>
            }
<span class="nc" id="L476">            List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc bnc" id="L477" title="All 2 branches missed.">            if (data.isBeanStyleLight()) {</span>
                // light
<span class="nc" id="L479">                data.ensureImport(LightMetaBean.class);</span>
<span class="nc" id="L480">                data.ensureImport(MethodHandles.class);</span>
<span class="nc" id="L481">                boolean specialInit = nonDerived.stream().filter(p -&gt; p.isSpecialInit()).findAny().isPresent();</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">                if (nonDerived.isEmpty()) {</span>
<span class="nc" id="L483">                    insertRegion.add(&quot;\t\t\tLightMetaBean.of(&quot; + data.getTypeRaw() + &quot;.class, MethodHandles.lookup());&quot;);</span>
                } else {
<span class="nc" id="L485">                    insertRegion.add(&quot;\t\t\tLightMetaBean.of(&quot;);</span>
<span class="nc" id="L486">                    insertRegion.add(&quot;\t\t\t\t\t&quot; + data.getTypeRaw() + &quot;.class,&quot;);</span>
<span class="nc" id="L487">                    insertRegion.add(&quot;\t\t\t\t\tMethodHandles.lookup(),&quot;);</span>
<span class="nc" id="L488">                    generateFieldNames(nonDerived);</span>
<span class="nc bnc" id="L489" title="All 2 branches missed.">                    if (specialInit) {</span>
<span class="nc bnc" id="L490" title="All 2 branches missed.">                        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L491">                            insertRegion.add(</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">                                    &quot;\t\t\t\t\t&quot; + nonDerived.get(i).generateInit() + (i &lt; nonDerived.size() - 1 ? &quot;,&quot; : &quot;);&quot;));</span>
                        }
                    } else {
<span class="nc" id="L495">                        insertRegion.add(&quot;\t\t\t\t\tnew Object[0]);&quot;);</span>
                    }
                }
<span class="nc" id="L498">            } else {</span>
<span class="nc" id="L499">                data.ensureImport(MinimalMetaBean.class);</span>
<span class="nc" id="L500">                insertRegion.add(&quot;\t\t\tMinimalMetaBean.of(&quot;);</span>
<span class="nc" id="L501">                insertRegion.add(&quot;\t\t\t\t\t&quot; + data.getTypeRaw() + &quot;.class,&quot;);</span>
<span class="nc" id="L502">                generateFieldNames(nonDerived);</span>
<span class="nc" id="L503">                String builderLambda = &quot;\t\t\t\t\t() -&gt; new &quot; + data.getTypeRaw() + &quot;.Builder()&quot;;</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                if (data.isSkipBuilderGeneration()) {</span>
<span class="nc" id="L505">                    data.ensureImport(BasicBeanBuilder.class);</span>
<span class="nc" id="L506">                    builderLambda = &quot;\t\t\t\t\t() -&gt; new BasicBeanBuilder&lt;&gt;(new &quot; + data.getTypeWithDiamond() + &quot;())&quot;;</span>
                }
<span class="nc bnc" id="L508" title="All 2 branches missed.">                if (nonDerived.isEmpty()) {</span>
<span class="nc bnc" id="L509" title="All 2 branches missed.">                    if (data.isImmutable()) {</span>
<span class="nc" id="L510">                        insertRegion.add(builderLambda + &quot;);&quot;);</span>
                    } else {
<span class="nc" id="L512">                        data.ensureImport(Collections.class);</span>
<span class="nc" id="L513">                        data.ensureImport(Function.class);</span>
<span class="nc" id="L514">                        data.ensureImport(BiConsumer.class);</span>
<span class="nc" id="L515">                        insertRegion.add(builderLambda + &quot;,&quot;);</span>
<span class="nc" id="L516">                        insertRegion.add(&quot;\t\t\t\t\tCollections.&lt;Function&lt;&quot; + data.getTypeRaw() + &quot;, Object&gt;&gt;emptyList(),&quot;);</span>
<span class="nc" id="L517">                        insertRegion.add(&quot;\t\t\t\t\tCollections.&lt;BiConsumer&lt;&quot; + data.getTypeRaw() + &quot;, Object&gt;&gt;emptyList());&quot;);</span>
                    }
                } else {
<span class="nc" id="L520">                    insertRegion.add(builderLambda + &quot;,&quot;);</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">                    if (data.isImmutable()) {</span>
<span class="nc bnc" id="L522" title="All 2 branches missed.">                        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">                            if (i &lt; nonDerived.size() - 1) {</span>
<span class="nc" id="L524">                                insertRegion.add(&quot;\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaGetter() + &quot;,&quot;);</span>
                            } else {
<span class="nc" id="L526">                                insertRegion.add(&quot;\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaGetter() + &quot;);&quot;);</span>
                            }
                        }
                    } else {
<span class="nc" id="L530">                        data.ensureImport(Arrays.class);</span>
<span class="nc" id="L531">                        data.ensureImport(Function.class);</span>
<span class="nc" id="L532">                        data.ensureImport(BiConsumer.class);</span>
<span class="nc" id="L533">                        insertRegion.add(&quot;\t\t\t\t\tArrays.&lt;Function&lt;&quot; + data.getTypeRaw() + &quot;, Object&gt;&gt;asList(&quot;);</span>
<span class="nc bnc" id="L534" title="All 2 branches missed.">                        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">                            if (i &lt; nonDerived.size() - 1) {</span>
<span class="nc" id="L536">                                insertRegion.add(&quot;\t\t\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaGetter() + &quot;,&quot;);</span>
                            } else {
<span class="nc" id="L538">                                insertRegion.add(&quot;\t\t\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaGetter() + &quot;),&quot;);</span>
                            }
                        }
<span class="nc" id="L541">                        insertRegion.add(&quot;\t\t\t\t\tArrays.&lt;BiConsumer&lt;&quot; + data.getTypeRaw() + &quot;, Object&gt;&gt;asList(&quot;);</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">                        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">                            if (i &lt; nonDerived.size() - 1) {</span>
<span class="nc" id="L544">                                insertRegion.add(&quot;\t\t\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaSetter() + &quot;,&quot;);</span>
                            } else {
<span class="nc" id="L546">                                insertRegion.add(&quot;\t\t\t\t\t\t\t&quot; + nonDerived.get(i).generateLambdaSetter() + &quot;));&quot;);</span>
                            }
                        }
                    }
                }
            }
<span class="nc" id="L552">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L553">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L554">            insertRegion.add(&quot;\t * The meta-bean for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc" id="L555">            insertRegion.add(&quot;\t * @return the meta-bean, not null&quot;);</span>
<span class="nc" id="L556">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc bnc" id="L557" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc" id="L558">                insertRegion.add(&quot;\tpublic static MetaBean meta() {&quot;);</span>
            } else {
<span class="nc" id="L560">                insertRegion.add(&quot;\tpublic static TypedMetaBean&lt;&quot; + data.getTypeNoExtends() + &quot;&gt; meta() {&quot;);</span>
            }
<span class="nc" id="L562">            insertRegion.add(&quot;\t\treturn META_BEAN;&quot;);</span>
<span class="nc" id="L563">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L564">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L565">            insertRegion.add(&quot;\tstatic {&quot;);</span>
<span class="nc" id="L566">            data.ensureImport(MetaBean.class);</span>
<span class="nc" id="L567">            insertRegion.add(&quot;\t\tMetaBean.register(META_BEAN);&quot;);</span>
<span class="nc" id="L568">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L569">            insertRegion.add(&quot;&quot;);</span>
            
<span class="nc" id="L571">        } else {</span>
            // this cannot be generified without either Eclipse or javac complaining
            // raw types forever
<span class="nc" id="L574">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L575">            insertRegion.add(&quot;\t * The meta-bean for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc" id="L576">            insertRegion.add(&quot;\t * @return the meta-bean, not null&quot;);</span>
<span class="nc bnc" id="L577" title="All 2 branches missed.">            if (data.isMetaScopePrivate()) {</span>
<span class="nc" id="L578">                data.ensureImport(MetaBean.class);</span>
<span class="nc" id="L579">                insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L580">                insertRegion.add(&quot;\tpublic static MetaBean meta() {&quot;);</span>
<span class="nc bnc" id="L581" title="All 2 branches missed.">            } else if (data.isTypeGeneric()) {</span>
<span class="nc" id="L582">                insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L583">                insertRegion.add(&quot;\t@SuppressWarnings(\&quot;rawtypes\&quot;)&quot;);</span>
<span class="nc" id="L584">                insertRegion.add(&quot;\tpublic static &quot; + data.getTypeRaw() + &quot;.Meta meta() {&quot;);</span>
            } else {
<span class="nc" id="L586">                insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L587">                insertRegion.add(&quot;\tpublic static &quot; + data.getTypeRaw() + &quot;.Meta meta() {&quot;);</span>
            }
<span class="nc" id="L589">            insertRegion.add(&quot;\t\treturn &quot; + data.getTypeRaw() + &quot;.Meta.INSTANCE;&quot;);</span>
<span class="nc" id="L590">            insertRegion.add(&quot;\t}&quot;);</span>
            
<span class="nc bnc" id="L592" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc" id="L593">                generateMetaForGenericType();</span>
            }
            
<span class="nc" id="L596">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L597">            insertRegion.add(&quot;\tstatic {&quot;);</span>
<span class="nc" id="L598">            data.ensureImport(MetaBean.class);</span>
<span class="nc" id="L599">            insertRegion.add(&quot;\t\tMetaBean.register(&quot; + data.getTypeRaw() + &quot;.Meta.INSTANCE);&quot;);</span>
<span class="nc" id="L600">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L601">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L603">    }</span>

    private void generateFieldNames(List&lt;PropertyGen&gt; nonDerived) {
<span class="nc bnc" id="L606" title="All 2 branches missed.">        if (nonDerived.isEmpty()) {</span>
<span class="nc" id="L607">            insertRegion.add(&quot;\t\t\t\t\tnew String[0],&quot;);</span>
        } else {
<span class="nc" id="L609">            insertRegion.add(&quot;\t\t\t\t\tnew String[] {&quot;);</span>
<span class="nc bnc" id="L610" title="All 2 branches missed.">            for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L611" title="All 2 branches missed.">                if (i &lt; nonDerived.size() - 1) {</span>
<span class="nc" id="L612">                    insertRegion.add(&quot;\t\t\t\t\t\t\t\&quot;&quot; + nonDerived.get(i).getData().getFieldName() + &quot;\&quot;,&quot;);</span>
                } else {
<span class="nc" id="L614">                    insertRegion.add(&quot;\t\t\t\t\t\t\t\&quot;&quot; + nonDerived.get(i).getData().getFieldName() + &quot;\&quot;},&quot;);</span>
                }
            }
        }
<span class="nc" id="L618">    }</span>

    private void generateMetaForGenericType() {
        // this works around an Eclipse bug https://bugs.eclipse.org/bugs/show_bug.cgi?id=397462
        // long name needed for uniqueness as static overriding is borked
<span class="nc" id="L623">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L624">        insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L625">        insertRegion.add(&quot;\t * The meta-bean for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc bnc" id="L626" title="All 2 branches missed.">        if (data.getTypeGenericCount() == 1) {</span>
<span class="nc" id="L627">            insertRegion.add(&quot;\t * @param &lt;R&gt;  the bean's generic type&quot;);</span>
<span class="nc" id="L628">            insertRegion.add(&quot;\t * @param cls  the bean's generic type&quot;);</span>
<span class="nc bnc" id="L629" title="All 2 branches missed.">        } else if (data.getTypeGenericCount() == 2) {</span>
<span class="nc" id="L630">            insertRegion.add(&quot;\t * @param &lt;R&gt;  the first generic type&quot;);</span>
<span class="nc" id="L631">            insertRegion.add(&quot;\t * @param &lt;S&gt;  the second generic type&quot;);</span>
<span class="nc" id="L632">            insertRegion.add(&quot;\t * @param cls1  the first generic type&quot;);</span>
<span class="nc" id="L633">            insertRegion.add(&quot;\t * @param cls2  the second generic type&quot;);</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">        } else if (data.getTypeGenericCount() == 3) {</span>
<span class="nc" id="L635">            insertRegion.add(&quot;\t * @param &lt;R&gt;  the first generic type&quot;);</span>
<span class="nc" id="L636">            insertRegion.add(&quot;\t * @param &lt;S&gt;  the second generic type&quot;);</span>
<span class="nc" id="L637">            insertRegion.add(&quot;\t * @param &lt;T&gt;  the second generic type&quot;);</span>
<span class="nc" id="L638">            insertRegion.add(&quot;\t * @param cls1  the first generic type&quot;);</span>
<span class="nc" id="L639">            insertRegion.add(&quot;\t * @param cls2  the second generic type&quot;);</span>
<span class="nc" id="L640">            insertRegion.add(&quot;\t * @param cls3  the third generic type&quot;);</span>
        }
<span class="nc" id="L642">        insertRegion.add(&quot;\t * @return the meta-bean, not null&quot;);</span>
<span class="nc" id="L643">        insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L644">        insertRegion.add(&quot;\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
<span class="nc" id="L645">        String[] typeNames = new String[] {&quot;R&quot;, &quot;S&quot;, &quot;T&quot;};</span>
<span class="nc bnc" id="L646" title="All 2 branches missed.">        if (data.getTypeGenericCount() == 1) {</span>
<span class="nc" id="L647">            insertRegion.add(&quot;\tpublic static &lt;R&quot; + data.getTypeGenericExtends(0, typeNames) +</span>
<span class="nc" id="L648">                    &quot;&gt; &quot; + data.getTypeRaw() + &quot;.Meta&lt;R&gt; meta&quot; + data.getTypeRaw() + &quot;(Class&lt;R&gt; cls) {&quot;);</span>
<span class="nc bnc" id="L649" title="All 2 branches missed.">        } else if (data.getTypeGenericCount() == 2) {</span>
<span class="nc" id="L650">            insertRegion.add(&quot;\tpublic static &lt;R&quot; + data.getTypeGenericExtends(0, typeNames) +</span>
<span class="nc" id="L651">                    &quot;, S&quot; + data.getTypeGenericExtends(1, typeNames) + &quot;&gt; &quot; + data.getTypeRaw() +</span>
<span class="nc" id="L652">                    &quot;.Meta&lt;R, S&gt; meta&quot; + data.getTypeRaw() + &quot;(Class&lt;R&gt; cls1, Class&lt;S&gt; cls2) {&quot;);</span>
<span class="nc bnc" id="L653" title="All 2 branches missed.">        } else if (data.getTypeGenericCount() == 3) {</span>
<span class="nc" id="L654">            insertRegion.add(&quot;\tpublic static &lt;R&quot; + data.getTypeGenericExtends(0, typeNames) +</span>
<span class="nc" id="L655">                    &quot;, S&quot; + data.getTypeGenericExtends(1, typeNames) +</span>
<span class="nc" id="L656">                    &quot;, T&quot; + data.getTypeGenericExtends(2, typeNames) +</span>
<span class="nc" id="L657">                    &quot;&gt; &quot; + data.getTypeRaw() +</span>
<span class="nc" id="L658">                    &quot;.Meta&lt;R, S, T&gt; meta&quot; + data.getTypeRaw() + &quot;(Class&lt;R&gt; cls1, Class&lt;S&gt; cls2, Class&lt;T&gt; cls3) {&quot;);</span>
        }
<span class="nc" id="L660">        insertRegion.add(&quot;\t\treturn &quot; + data.getTypeRaw() + &quot;.Meta.INSTANCE;&quot;);</span>
<span class="nc" id="L661">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L662">    }</span>

    private void generateSerializationVersionId() {
<span class="nc bnc" id="L665" title="All 4 branches missed.">        if (data.isSerializable() &amp;&amp; !data.isManualSerializationId()) {</span>
<span class="nc" id="L666">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L667">            insertRegion.add(&quot;\t * The serialization version id.&quot;);</span>
<span class="nc" id="L668">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L669">            insertRegion.add(&quot;\tprivate static final long serialVersionUID = 1L;&quot;);</span>
<span class="nc" id="L670">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L672">    }</span>

    private void generatePropertyChangeSupportField() {
<span class="nc bnc" id="L675" title="All 2 branches missed.">        if (data.isPropertyChangeSupport()) {</span>
<span class="nc" id="L676">            data.ensureImport(CLASS_PROPERTY_CHANGE_SUPPORT);</span>
<span class="nc" id="L677">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L678">            insertRegion.add(&quot;\t * The property change support field.&quot;);</span>
<span class="nc" id="L679">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L680">            insertRegion.add(&quot;\tprivate final transient PropertyChangeSupport &quot; + config.getPrefix() + &quot;propertyChangeSupport = new PropertyChangeSupport(this);&quot;);</span>
<span class="nc" id="L681">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L683">    }</span>

    private void generateHashCodeField() {
<span class="nc bnc" id="L686" title="All 2 branches missed.">        if (data.isCacheHashCode()) {</span>
<span class="nc" id="L687">            insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L688">            insertRegion.add(&quot;\t * The cached hash code, using the racy single-check idiom.&quot;);</span>
<span class="nc" id="L689">            insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc" id="L690">            insertRegion.add(&quot;\tprivate transient int &quot; + config.getPrefix() + &quot;cacheHashCode;&quot;);</span>
<span class="nc" id="L691">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L693">    }</span>

    private void generateMetaBean() {
<span class="nc bnc" id="L696" title="All 4 branches missed.">        if (data.isMetaScopePrivate() || data.isBeanStyleMinimal()) {</span>
<span class="nc" id="L697">            insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">            if (data.isBeanStyleLightOrMinimal()) {</span>
<span class="nc" id="L699">                data.ensureImport(TypedMetaBean.class);</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">                if (data.isTypeGeneric()) {</span>
<span class="nc" id="L701">                    insertRegion.add(&quot;\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
                }
<span class="nc" id="L703">                insertRegion.add(&quot;\tpublic TypedMetaBean&lt;&quot; + data.getTypeNoExtends() + &quot;&gt; metaBean() {&quot;);</span>
<span class="nc bnc" id="L704" title="All 2 branches missed.">                if (data.isTypeGeneric()) {</span>
<span class="nc" id="L705">                    insertRegion.add(&quot;\t\treturn (TypedMetaBean&lt;&quot; + data.getTypeNoExtends() + &quot;&gt;) META_BEAN;&quot;);</span>
                } else {
<span class="nc" id="L707">                    insertRegion.add(&quot;\t\treturn META_BEAN;&quot;);</span>
                }
            } else {
<span class="nc" id="L710">                data.ensureImport(MetaBean.class);</span>
<span class="nc" id="L711">                insertRegion.add(&quot;\tpublic MetaBean metaBean() {&quot;);</span>
<span class="nc" id="L712">                insertRegion.add(&quot;\t\treturn &quot; + data.getTypeRaw() + &quot;.Meta.INSTANCE;&quot;);</span>
            }
<span class="nc" id="L714">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L715">            insertRegion.add(&quot;&quot;);</span>
        } else {
<span class="nc bnc" id="L717" title="All 2 branches missed.">            if (data.isTypeGeneric()) {</span>
<span class="nc" id="L718">                insertRegion.add(&quot;\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
            }
<span class="nc" id="L720">            insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc" id="L721">            insertRegion.add(&quot;\tpublic &quot; + data.getTypeRaw() +</span>
<span class="nc" id="L722">                    &quot;.Meta&quot; + data.getTypeGenericName(true) + &quot; metaBean() {&quot;);</span>
<span class="nc" id="L723">            insertRegion.add(&quot;\t\treturn &quot; + data.getTypeRaw() + &quot;.Meta.INSTANCE;&quot;);</span>
<span class="nc" id="L724">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L725">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L727">    }</span>

    private void generateGettersSetters() {
<span class="nc bnc" id="L730" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc" id="L731">            generateSeparator();</span>
<span class="nc" id="L732">            insertRegion.addAll(prop.generateGetter());</span>
<span class="nc bnc" id="L733" title="All 2 branches missed.">            if (data.isMutable()) {</span>
<span class="nc" id="L734">                insertRegion.addAll(prop.generateSetter());</span>
            }
<span class="nc bnc" id="L736" title="All 2 branches missed.">            if (data.isBeanStyleGenerateProperties()) {</span>
<span class="nc" id="L737">                insertRegion.addAll(prop.generateProperty());</span>
            }
<span class="nc" id="L739">        }</span>
<span class="nc" id="L740">    }</span>

    //-----------------------------------------------------------------------
    private void generateImmutableToBuilder() {
<span class="nc bnc" id="L744" title="All 4 branches missed.">        if (data.isImmutable() &amp;&amp; data.isEffectiveBuilderScopeVisible()) {</span>
<span class="nc bnc" id="L745" title="All 2 branches missed.">            if (data.isConstructable()) {</span>
<span class="nc" id="L746">                List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc bnc" id="L747" title="All 2 branches missed.">                if (nonDerived.size() &gt; 0) {</span>
<span class="nc" id="L748">                    insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L749">                    insertRegion.add(&quot;\t * Returns a builder that allows this bean to be mutated.&quot;);</span>
<span class="nc" id="L750">                    insertRegion.add(&quot;\t * @return the mutable builder, not null&quot;);</span>
<span class="nc" id="L751">                    insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc bnc" id="L752" title="All 2 branches missed.">                    if (data.isRootClass() == false) {</span>
<span class="nc" id="L753">                        insertRegion.add(&quot;\t@Override&quot;);</span>
                    }
<span class="nc" id="L755">                    insertRegion.add(&quot;\t&quot; + data.getEffectiveBuilderScope() + &quot;Builder&quot; + data.getTypeGenericName(true) + &quot; toBuilder() {&quot;);</span>
<span class="nc" id="L756">                    insertRegion.add(&quot;\t\treturn new Builder&quot; + data.getTypeGenericDiamond() + &quot;(this);&quot;);</span>
<span class="nc" id="L757">                    insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L758">                    insertRegion.add(&quot;&quot;);</span>
                }
<span class="nc" id="L760">            } else {</span>
<span class="nc" id="L761">                insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L762">                insertRegion.add(&quot;\t * Returns a builder that allows this bean to be mutated.&quot;);</span>
<span class="nc" id="L763">                insertRegion.add(&quot;\t * @return the mutable builder, not null&quot;);</span>
<span class="nc" id="L764">                insertRegion.add(&quot;\t */&quot;);</span>
<span class="nc bnc" id="L765" title="All 2 branches missed.">                if (data.isRootClass() == false) {</span>
<span class="nc" id="L766">                    insertRegion.add(&quot;\t@Override&quot;);</span>
                }
<span class="nc" id="L768">                insertRegion.add(&quot;\tpublic abstract Builder&quot; + data.getTypeGenericName(true) + &quot; toBuilder();&quot;);</span>
<span class="nc" id="L769">                insertRegion.add(&quot;&quot;);</span>
            }
        }
<span class="nc" id="L772">    }</span>

    private void generateClone() {
<span class="nc bnc" id="L775" title="All 2 branches missed.">        if (data.isSkipCloneGeneration() ||</span>
<span class="nc bnc" id="L776" title="All 2 branches missed.">                data.isManualClone() ||</span>
<span class="nc bnc" id="L777" title="All 4 branches missed.">                (data.isRootClass() == false &amp;&amp; data.isConstructable() == false)) {</span>
<span class="nc" id="L778">            return;</span>
        }
<span class="nc" id="L780">        insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">        if (data.isImmutable()) {</span>
<span class="nc" id="L782">            insertRegion.add(&quot;\tpublic &quot; + data.getTypeNoExtends() + &quot; clone() {&quot;);</span>
<span class="nc" id="L783">            insertRegion.add(&quot;\t\treturn this;&quot;);</span>
        } else {
<span class="nc" id="L785">            data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L786">            insertRegion.add(&quot;\tpublic &quot; + data.getTypeNoExtends() + &quot; clone() {&quot;);</span>
<span class="nc" id="L787">            insertRegion.add(&quot;\t\treturn JodaBeanUtils.cloneAlways(this);&quot;);</span>
        }
<span class="nc" id="L789">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L790">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L791">    }</span>

    private void generateEquals() {
<span class="nc bnc" id="L794" title="All 2 branches missed.">        if (data.isManualEqualsHashCode()) {</span>
<span class="nc" id="L795">            return;</span>
        }
<span class="nc" id="L797">        insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc" id="L798">        insertRegion.add(&quot;\tpublic boolean equals(Object obj) {&quot;);</span>
<span class="nc" id="L799">        insertRegion.add(&quot;\t\tif (obj == this) {&quot;);</span>
<span class="nc" id="L800">        insertRegion.add(&quot;\t\t\treturn true;&quot;);</span>
<span class="nc" id="L801">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L802">        insertRegion.add(&quot;\t\tif (obj != null &amp;&amp; obj.getClass() == this.getClass()) {&quot;);</span>
<span class="nc" id="L803">        List&lt;PropertyGen&gt; nonDerived = nonDerivedEqualsHashCodeProperties();</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">        if (nonDerived.size() == 0) {</span>
<span class="nc bnc" id="L805" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L806">                insertRegion.add(&quot;\t\t\treturn super.equals(obj);&quot;);</span>
            } else {
<span class="nc" id="L808">                insertRegion.add(&quot;\t\t\treturn true;&quot;);</span>
            }
        } else {
<span class="nc" id="L811">            insertRegion.add(&quot;\t\t\t&quot; + data.getTypeWildcard() + &quot; other = (&quot; + data.getTypeWildcard() + &quot;) obj;&quot;);</span>
<span class="nc bnc" id="L812" title="All 2 branches missed.">            for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L813">                PropertyGen prop = nonDerived.get(i);</span>
<span class="nc" id="L814">                String getter = equalsHashCodeFieldAccessor(prop);</span>
<span class="nc" id="L815">                data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L816">                String equals = &quot;JodaBeanUtils.equal(&quot; + getter + &quot;, other.&quot; + getter + &quot;)&quot;;</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">                if (PRIMITIVE_EQUALS.contains(prop.getData().getType())) {</span>
<span class="nc" id="L818">                    equals = &quot;(&quot; + getter + &quot; == other.&quot; + getter + &quot;)&quot;;</span>
                }
<span class="nc" id="L820">                insertRegion.add(</span>
<span class="nc bnc" id="L821" title="All 2 branches missed.">                        (i == 0 ? &quot;\t\t\treturn &quot; : &quot;\t\t\t\t\t&quot;) + equals +</span>
<span class="nc bnc" id="L822" title="All 4 branches missed.">                        (data.isSubClass() || i &lt; nonDerived.size() - 1 ? &quot; &amp;&amp;&quot; : &quot;;&quot;));</span>
            }
<span class="nc bnc" id="L824" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L825">                insertRegion.add(&quot;\t\t\t\t\tsuper.equals(obj);&quot;);</span>
            }
        }
<span class="nc" id="L828">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L829">        insertRegion.add(&quot;\t\treturn false;&quot;);</span>
<span class="nc" id="L830">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L831">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L832">    }</span>

    private void generateHashCode() {
<span class="nc bnc" id="L835" title="All 2 branches missed.">        if (data.isManualEqualsHashCode()) {</span>
<span class="nc" id="L836">            return;</span>
        }
<span class="nc" id="L838">        insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc" id="L839">        insertRegion.add(&quot;\tpublic int hashCode() {&quot;);</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">        if (data.isCacheHashCode()) {</span>
<span class="nc" id="L841">            insertRegion.add(&quot;\t\tint hash = &quot; + config.getPrefix() + &quot;cacheHashCode;&quot;);</span>
<span class="nc" id="L842">            insertRegion.add(&quot;\t\tif (hash == 0) {&quot;);</span>
<span class="nc bnc" id="L843" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L844">                insertRegion.add(&quot;\t\t\thash = 7;&quot;);</span>
            } else {
<span class="nc" id="L846">                insertRegion.add(&quot;\t\t\thash = getClass().hashCode();&quot;);</span>
            }
<span class="nc" id="L848">            generateHashCodeContent(&quot;\t\t\t&quot;);</span>
<span class="nc bnc" id="L849" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L850">                insertRegion.add(&quot;\t\t\thash = hash ^ super.hashCode();&quot;);</span>
            }
<span class="nc" id="L852">            insertRegion.add(&quot;\t\t\t&quot; + config.getPrefix() + &quot;cacheHashCode = hash;&quot;);</span>
<span class="nc" id="L853">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L854">            insertRegion.add(&quot;\t\treturn hash;&quot;);</span>
        } else {
<span class="nc bnc" id="L856" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L857">                insertRegion.add(&quot;\t\tint hash = 7;&quot;);</span>
            } else {
<span class="nc" id="L859">                insertRegion.add(&quot;\t\tint hash = getClass().hashCode();&quot;);</span>
            }
<span class="nc" id="L861">            generateHashCodeContent(&quot;\t\t&quot;);</span>
<span class="nc bnc" id="L862" title="All 2 branches missed.">            if (data.isSubClass()) {</span>
<span class="nc" id="L863">                insertRegion.add(&quot;\t\treturn hash ^ super.hashCode();&quot;);</span>
            } else {
<span class="nc" id="L865">                insertRegion.add(&quot;\t\treturn hash;&quot;);</span>
            }
        }
<span class="nc" id="L868">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L869">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L870">    }</span>

    private void generateHashCodeContent(String indent) {
<span class="nc" id="L873">        List&lt;PropertyGen&gt; nonDerived = nonDerivedEqualsHashCodeProperties();</span>
<span class="nc bnc" id="L874" title="All 2 branches missed.">        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L875">            PropertyGen prop = nonDerived.get(i);</span>
<span class="nc" id="L876">            String getter = equalsHashCodeFieldAccessor(prop);</span>
<span class="nc" id="L877">            data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L878">            insertRegion.add(indent + &quot;hash = hash * 31 + JodaBeanUtils.hashCode(&quot; + getter + &quot;);&quot;);</span>
        }
<span class="nc" id="L880">    }</span>

    private String equalsHashCodeFieldAccessor(PropertyGen prop) {
<span class="nc bnc" id="L883" title="All 2 branches missed.">        if (prop.getData().getEqualsHashCodeStyle().equals(&quot;field&quot;)) {</span>
<span class="nc" id="L884">            return prop.getData().getFieldName();</span>
        } else {
<span class="nc" id="L886">            return prop.getData().getGetterGen().generateGetInvoke(prop.getData());</span>
        }
    }

    private void generateToString() {
<span class="nc bnc" id="L891" title="All 2 branches missed.">        if (data.isManualToStringCode()) {</span>
<span class="nc" id="L892">            return;</span>
        }
<span class="nc" id="L894">        List&lt;PropertyGen&gt; props = toStringProperties();</span>
<span class="nc bnc" id="L895" title="All 4 branches missed.">        if (data.isRootClass() &amp;&amp; data.isTypeFinal()) {</span>
<span class="nc" id="L896">            insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc" id="L897">            insertRegion.add(&quot;\tpublic String toString() {&quot;);</span>
<span class="nc" id="L898">            insertRegion.add(&quot;\t\tStringBuilder buf = new StringBuilder(&quot; + (props.size() * 32 + 32) + &quot;);&quot;);</span>
<span class="nc" id="L899">            insertRegion.add(&quot;\t\tbuf.append(\&quot;&quot; + data.getTypeRaw() + &quot;{\&quot;);&quot;);</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">            for (int i = 0; i &lt; props.size(); i++) {</span>
<span class="nc" id="L901">                PropertyGen prop = props.get(i);</span>
<span class="nc" id="L902">                String getter = toStringFieldAccessor(prop);</span>
<span class="nc bnc" id="L903" title="All 2 branches missed.">                if (i &lt; props.size() - 1) {</span>
<span class="nc" id="L904">                    insertRegion.add(&quot;\t\tbuf.append(\&quot;&quot; + prop.getData().getPropertyName() +</span>
                            &quot;\&quot;).append('=').append(&quot; + getter + &quot;).append(',').append(' ');&quot;);
                } else {
<span class="nc" id="L907">                    data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L908">                    insertRegion.add(&quot;\t\tbuf.append(\&quot;&quot; + prop.getData().getPropertyName() +</span>
                            &quot;\&quot;).append('=').append(JodaBeanUtils.toString(&quot; + getter + &quot;));&quot;);
                }
            }
<span class="nc" id="L912">            insertRegion.add(&quot;\t\tbuf.append('}');&quot;);</span>
<span class="nc" id="L913">            insertRegion.add(&quot;\t\treturn buf.toString();&quot;);</span>
<span class="nc" id="L914">            insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L915">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L916">            return;</span>
        }
        
<span class="nc" id="L919">        insertRegion.add(&quot;\t@Override&quot;);</span>
<span class="nc" id="L920">        insertRegion.add(&quot;\tpublic String toString() {&quot;);</span>
<span class="nc" id="L921">        insertRegion.add(&quot;\t\tStringBuilder buf = new StringBuilder(&quot; + (props.size() * 32 + 32) + &quot;);&quot;);</span>
<span class="nc" id="L922">        insertRegion.add(&quot;\t\tbuf.append(\&quot;&quot; + data.getTypeRaw() + &quot;{\&quot;);&quot;);</span>
<span class="nc" id="L923">        insertRegion.add(&quot;\t\tint len = buf.length();&quot;);</span>
<span class="nc" id="L924">        insertRegion.add(&quot;\t\ttoString(buf);&quot;);</span>
<span class="nc" id="L925">        insertRegion.add(&quot;\t\tif (buf.length() &gt; len) {&quot;);</span>
<span class="nc" id="L926">        insertRegion.add(&quot;\t\t\tbuf.setLength(buf.length() - 2);&quot;);</span>
<span class="nc" id="L927">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L928">        insertRegion.add(&quot;\t\tbuf.append('}');&quot;);</span>
<span class="nc" id="L929">        insertRegion.add(&quot;\t\treturn buf.toString();&quot;);</span>
<span class="nc" id="L930">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L931">        insertRegion.add(&quot;&quot;);</span>
        
<span class="nc bnc" id="L933" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L934">            insertRegion.add(&quot;\t@Override&quot;);</span>
        }
<span class="nc" id="L936">        insertRegion.add(&quot;\tprotected void toString(StringBuilder buf) {&quot;);</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L938">            insertRegion.add(&quot;\t\tsuper.toString(buf);&quot;);</span>
        }
<span class="nc bnc" id="L940" title="All 2 branches missed.">        for (int i = 0; i &lt; props.size(); i++) {</span>
<span class="nc" id="L941">            PropertyGen prop = props.get(i);</span>
<span class="nc" id="L942">            String getter = toStringFieldAccessor(prop);</span>
<span class="nc" id="L943">            data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L944">            insertRegion.add(&quot;\t\tbuf.append(\&quot;&quot; + prop.getData().getPropertyName() +</span>
                    &quot;\&quot;).append('=').append(JodaBeanUtils.toString(&quot; + getter + &quot;)).append(',').append(' ');&quot;);
        }
<span class="nc" id="L947">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L948">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L949">    }</span>

    private String toStringFieldAccessor(PropertyGen prop) {
<span class="nc bnc" id="L952" title="All 2 branches missed.">        if (prop.getData().isDerived()) {</span>
<span class="nc" id="L953">            return prop.getData().getGetterGen().generateGetInvoke(prop.getData());</span>
<span class="nc bnc" id="L954" title="All 2 branches missed.">        } else if (prop.getData().getToStringStyle().equals(&quot;field&quot;)) {</span>
<span class="nc" id="L955">            return prop.getData().getFieldName();</span>
        } else {
<span class="nc" id="L957">            return prop.getData().getGetterGen().generateGetInvoke(prop.getData());</span>
        }
    }

    //-----------------------------------------------------------------------
    private void generateMetaClass() {
<span class="nc bnc" id="L963" title="All 2 branches missed.">        if (data.isBeanStyleLightOrMinimal()) {</span>
<span class="nc" id="L964">            return;</span>
        }
<span class="nc" id="L966">        generateSeparator();</span>
<span class="nc" id="L967">        insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L968">        insertRegion.add(&quot;\t * The meta-bean for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc bnc" id="L969" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc bnc" id="L970" title="All 2 branches missed.">            for (int j = 0; j &lt; data.getTypeGenericCount(); j++) {</span>
<span class="nc" id="L971">                insertRegion.add(&quot;\t * @param &quot; + data.getTypeGenericName(j, true) + &quot;  the type&quot;);</span>
            }
        }
<span class="nc" id="L974">        insertRegion.add(&quot;\t */&quot;);</span>
        String superMeta;
<span class="nc bnc" id="L976" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L977">            superMeta = data.getSuperTypeRaw() + &quot;.Meta&quot; + data.getSuperTypeGeneric(true);</span>
        } else {
<span class="nc" id="L979">            data.ensureImport(DirectMetaBean.class);</span>
<span class="nc" id="L980">            superMeta = &quot;DirectMetaBean&quot;;</span>
        }
<span class="nc bnc" id="L982" title="All 2 branches missed.">        String finalType = data.isTypeFinal() ? &quot;final &quot; : &quot;&quot;;</span>
<span class="nc bnc" id="L983" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc" id="L984">            insertRegion.add(&quot;\t&quot; + data.getEffectiveMetaScope() + &quot;static &quot; + finalType + </span>
<span class="nc" id="L985">                    &quot;class Meta&quot; + data.getTypeGeneric(true) + &quot; extends &quot; + superMeta + &quot; {&quot;);</span>
        } else {
<span class="nc" id="L987">            insertRegion.add(&quot;\t&quot; + data.getEffectiveMetaScope() + &quot;static &quot; + finalType + </span>
                    &quot;class Meta extends &quot; + superMeta + &quot; {&quot;);
        }
<span class="nc" id="L990">        insertRegion.add(&quot;\t\t/**&quot;);</span>
<span class="nc" id="L991">        insertRegion.add(&quot;\t\t * The singleton instance of the meta-bean.&quot;);</span>
<span class="nc" id="L992">        insertRegion.add(&quot;\t\t */&quot;);</span>
<span class="nc bnc" id="L993" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc" id="L994">            insertRegion.add(&quot;\t\t@SuppressWarnings(\&quot;rawtypes\&quot;)&quot;);</span>
        }
<span class="nc" id="L996">        insertRegion.add(&quot;\t\tstatic final Meta INSTANCE = new Meta();&quot;);</span>
<span class="nc" id="L997">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L998">        generateMetaPropertyConstants();</span>
<span class="nc" id="L999">        generateMetaPropertyMapSetup();</span>
<span class="nc" id="L1000">        insertRegion.add(&quot;\t\t/**&quot;);</span>
<span class="nc" id="L1001">        insertRegion.add(&quot;\t\t * Restricted constructor.&quot;);</span>
<span class="nc" id="L1002">        insertRegion.add(&quot;\t\t */&quot;);</span>
<span class="nc" id="L1003">        insertRegion.add(&quot;\t\t&quot; + data.getNestedClassConstructorScope() + &quot; Meta() {&quot;);</span>
<span class="nc" id="L1004">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1005">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1006">        generateMetaPropertyGet();</span>
<span class="nc" id="L1007">        generateMetaBuilder();</span>
<span class="nc" id="L1008">        generateMetaBeanType();</span>
<span class="nc" id="L1009">        generateMetaPropertyMap();</span>
<span class="nc" id="L1010">        generateIndentedSeparator();</span>
<span class="nc" id="L1011">        generateMetaPropertyMethods();</span>
<span class="nc" id="L1012">        generateIndentedSeparator();</span>
<span class="nc" id="L1013">        generateMetaGetPropertyValue();</span>
<span class="nc" id="L1014">        generateMetaSetPropertyValue();</span>
<span class="nc" id="L1015">        generateMetaValidate();</span>
<span class="nc" id="L1016">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L1017">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1018">    }</span>

    private void generateMetaPropertyConstants() {
<span class="nc bnc" id="L1021" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc" id="L1022">            insertRegion.addAll(prop.generateMetaPropertyConstant());</span>
<span class="nc" id="L1023">        }</span>
<span class="nc" id="L1024">    }</span>

    private void generateMetaPropertyMapSetup() {
<span class="nc" id="L1027">        data.ensureImport(MetaProperty.class);</span>
<span class="nc" id="L1028">        data.ensureImport(DirectMetaPropertyMap.class);</span>
<span class="nc" id="L1029">        insertRegion.add(&quot;\t\t/**&quot;);</span>
<span class="nc" id="L1030">        insertRegion.add(&quot;\t\t * The meta-properties.&quot;);</span>
<span class="nc" id="L1031">        insertRegion.add(&quot;\t\t */&quot;);</span>
<span class="nc" id="L1032">        insertRegion.add(&quot;\t\tprivate final Map&lt;String, MetaProperty&lt;?&gt;&gt; &quot; + config.getPrefix() + &quot;metaPropertyMap$ = new DirectMetaPropertyMap(&quot;);</span>
<span class="nc bnc" id="L1033" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc bnc" id="L1034" title="All 2 branches missed.">            insertRegion.add(&quot;\t\t\t\tthis, (DirectMetaPropertyMap) super.metaPropertyMap()&quot; + (properties.size() == 0 ? &quot;);&quot; : &quot;,&quot;));</span>
        } else {
<span class="nc bnc" id="L1036" title="All 2 branches missed.">            insertRegion.add(&quot;\t\t\t\tthis, null&quot; + (properties.size() == 0 ? &quot;);&quot; : &quot;,&quot;));</span>
        }
<span class="nc bnc" id="L1038" title="All 2 branches missed.">        for (int i = 0; i &lt; properties.size(); i++) {</span>
<span class="nc" id="L1039">            String line = &quot;\t\t\t\t\&quot;&quot; + properties.get(i).getData().getPropertyName() + &quot;\&quot;&quot;;</span>
<span class="nc bnc" id="L1040" title="All 2 branches missed.">            line += (i + 1 == properties.size() ? &quot;);&quot; : &quot;,&quot;);</span>
<span class="nc" id="L1041">            insertRegion.add(line);</span>
        }
<span class="nc" id="L1043">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1044">    }</span>

    private void generateMetaBuilder() {
<span class="nc bnc" id="L1047" title="All 2 branches missed.">        if (!data.isConstructable()) {</span>
<span class="nc" id="L1048">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1049">            insertRegion.add(&quot;\t\tpublic boolean isBuildable() {&quot;);</span>
<span class="nc" id="L1050">            insertRegion.add(&quot;\t\t\treturn false;&quot;);</span>
<span class="nc" id="L1051">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1052">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L1054">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc bnc" id="L1055" title="All 4 branches missed.">        if (data.isImmutable() &amp;&amp; data.isEffectiveBuilderScopeVisible() == false) {</span>
<span class="nc" id="L1056">            data.ensureImport(BeanBuilder.class);</span>
<span class="nc" id="L1057">            insertRegion.add(&quot;\t\tpublic BeanBuilder&lt;? extends &quot; + data.getTypeNoExtends() + &quot;&gt; builder() {&quot;);</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">            if (data.isConstructable()) {</span>
<span class="nc" id="L1059">                insertRegion.add(&quot;\t\t\treturn new &quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericDiamond() + &quot;();&quot;);</span>
            } else {
<span class="nc" id="L1061">                insertRegion.add(&quot;\t\t\tthrow new UnsupportedOperationException(\&quot;&quot; + data.getTypeRaw() + &quot; is an abstract class\&quot;);&quot;);</span>
            }
<span class="nc bnc" id="L1063" title="All 6 branches missed.">        } else if (data.isImmutable() || (data.isMutable() &amp;&amp; data.isBuilderScopeVisible())) {</span>
<span class="nc" id="L1064">            insertRegion.add(&quot;\t\tpublic &quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericName(true) + &quot; builder() {&quot;);</span>
<span class="nc bnc" id="L1065" title="All 2 branches missed.">            if (data.isConstructable()) {</span>
<span class="nc" id="L1066">                insertRegion.add(&quot;\t\t\treturn new &quot; + data.getTypeRaw() + &quot;.Builder&quot; + data.getTypeGenericDiamond() + &quot;();&quot;);</span>
            } else {
<span class="nc" id="L1068">                insertRegion.add(&quot;\t\t\tthrow new UnsupportedOperationException(\&quot;&quot; + data.getTypeRaw() + &quot; is an abstract class\&quot;);&quot;);</span>
            }
        } else {
<span class="nc" id="L1071">            data.ensureImport(BeanBuilder.class);</span>
<span class="nc" id="L1072">            insertRegion.add(&quot;\t\tpublic BeanBuilder&lt;? extends &quot; + data.getTypeNoExtends() + &quot;&gt; builder() {&quot;);</span>
<span class="nc bnc" id="L1073" title="All 2 branches missed.">            if (data.isConstructable()) {</span>
<span class="nc" id="L1074">                data.ensureImport(DirectBeanBuilder.class);</span>
<span class="nc" id="L1075">                insertRegion.add(&quot;\t\t\treturn new DirectBeanBuilder&lt;&gt;(new &quot; + data.getTypeNoExtends() + &quot;());&quot;);</span>
            } else {
<span class="nc" id="L1077">                insertRegion.add(&quot;\t\t\tthrow new UnsupportedOperationException(\&quot;&quot; + data.getTypeRaw() + &quot; is an abstract class\&quot;);&quot;);</span>
            }
        }
<span class="nc" id="L1080">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1081">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1082">    }</span>

    private void generateMetaBeanType() {
<span class="nc bnc" id="L1085" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc" id="L1086">            insertRegion.add(&quot;\t\t@SuppressWarnings({\&quot;unchecked\&quot;, \&quot;rawtypes\&quot; })&quot;);</span>
        }
<span class="nc" id="L1088">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1089">        insertRegion.add(&quot;\t\tpublic Class&lt;? extends &quot; + data.getTypeNoExtends() + &quot;&gt; beanType() {&quot;);</span>
<span class="nc bnc" id="L1090" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc" id="L1091">            insertRegion.add(&quot;\t\t\treturn (Class) &quot; + data.getTypeRaw() + &quot;.class;&quot;);</span>
        } else {
<span class="nc" id="L1093">            insertRegion.add(&quot;\t\t\treturn &quot; + data.getTypeNoExtends() + &quot;.class;&quot;);</span>
        }
<span class="nc" id="L1095">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1096">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1097">    }</span>

    private void generateMetaPropertyGet() {
<span class="nc bnc" id="L1100" title="All 2 branches missed.">        if (properties.size() &gt; 0) {</span>
<span class="nc" id="L1101">            data.ensureImport(MetaProperty.class);</span>
<span class="nc" id="L1102">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1103">            insertRegion.add(&quot;\t\tprotected MetaProperty&lt;?&gt; metaPropertyGet(String propertyName) {&quot;);</span>
<span class="nc" id="L1104">            insertRegion.add(&quot;\t\t\tswitch (propertyName.hashCode()) {&quot;);</span>
<span class="nc bnc" id="L1105" title="All 2 branches missed.">            for (PropertyGen prop : properties) {</span>
<span class="nc" id="L1106">                insertRegion.addAll(prop.generateMetaPropertyGetCase());</span>
<span class="nc" id="L1107">            }</span>
<span class="nc" id="L1108">            insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1109">            insertRegion.add(&quot;\t\t\treturn super.metaPropertyGet(propertyName);&quot;);</span>
<span class="nc" id="L1110">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1111">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L1113">    }</span>

    private void generateMetaPropertyMap() {
<span class="nc" id="L1116">        data.ensureImport(Map.class);</span>
<span class="nc" id="L1117">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1118">        insertRegion.add(&quot;\t\tpublic Map&lt;String, MetaProperty&lt;?&gt;&gt; metaPropertyMap() {&quot;);</span>
<span class="nc" id="L1119">        insertRegion.add(&quot;\t\t\treturn &quot; + config.getPrefix() + &quot;metaPropertyMap$;&quot;);</span>
<span class="nc" id="L1120">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1121">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1122">    }</span>

    private void generateMetaPropertyMethods() {
<span class="nc bnc" id="L1125" title="All 2 branches missed.">        if (data.isBeanStyleGenerateMetaProperties()) {</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">            for (PropertyGen prop : properties) {</span>
<span class="nc" id="L1127">                insertRegion.addAll(prop.generateMetaProperty());</span>
<span class="nc" id="L1128">            }</span>
        }
<span class="nc" id="L1130">    }</span>

    //-----------------------------------------------------------------------
    private void generateMetaGetPropertyValue() {
<span class="nc bnc" id="L1134" title="All 2 branches missed.">        if (properties.size() == 0) {</span>
<span class="nc" id="L1135">            return;</span>
        }
<span class="nc" id="L1137">        data.ensureImport(Bean.class);</span>
<span class="nc" id="L1138">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1139">        insertRegion.add(&quot;\t\tprotected Object propertyGet(Bean bean, String propertyName, boolean quiet) {&quot;);</span>
<span class="nc" id="L1140">        insertRegion.add(&quot;\t\t\tswitch (propertyName.hashCode()) {&quot;);</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc" id="L1142">            insertRegion.addAll(prop.generatePropertyGetCase());</span>
<span class="nc" id="L1143">        }</span>
<span class="nc" id="L1144">        insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1145">        insertRegion.add(&quot;\t\t\treturn super.propertyGet(bean, propertyName, quiet);&quot;);</span>
<span class="nc" id="L1146">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1147">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1148">    }</span>

    private void generateMetaSetPropertyValue() {
<span class="nc bnc" id="L1151" title="All 2 branches missed.">        if (properties.size() == 0) {</span>
<span class="nc" id="L1152">            return;</span>
        }
<span class="nc" id="L1154">        data.ensureImport(Bean.class);</span>
<span class="nc bnc" id="L1155" title="All 2 branches missed.">        if (data.isImmutable()) {</span>
<span class="nc" id="L1156">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1157">            insertRegion.add(&quot;\t\tprotected void propertySet(Bean bean, String propertyName, Object newValue, boolean quiet) {&quot;);</span>
<span class="nc" id="L1158">            insertRegion.add(&quot;\t\t\tmetaProperty(propertyName);&quot;);</span>
<span class="nc" id="L1159">            insertRegion.add(&quot;\t\t\tif (quiet) {&quot;);</span>
<span class="nc" id="L1160">            insertRegion.add(&quot;\t\t\t\treturn;&quot;);</span>
<span class="nc" id="L1161">            insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1162">            insertRegion.add(&quot;\t\t\tthrow new UnsupportedOperationException(\&quot;Property cannot be written: \&quot; + propertyName);&quot;);</span>
<span class="nc" id="L1163">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1164">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1165">            return;</span>
        }
        
<span class="nc" id="L1168">        boolean generics = false;</span>
<span class="nc bnc" id="L1169" title="All 2 branches missed.">        for (PropertyData prop : data.getProperties()) {</span>
<span class="nc bnc" id="L1170" title="All 2 branches missed.">            generics |= (prop.getStyle().isWritable() &amp;&amp;</span>
<span class="nc bnc" id="L1171" title="All 6 branches missed.">                    ((prop.isGeneric() &amp;&amp; prop.isGenericWildcardParamType() == false) || data.isTypeGeneric()));</span>
<span class="nc" id="L1172">        }</span>
<span class="nc bnc" id="L1173" title="All 2 branches missed.">        if (generics) {</span>
<span class="nc" id="L1174">            insertRegion.add(&quot;\t\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
        }
<span class="nc" id="L1176">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1177">        insertRegion.add(&quot;\t\tprotected void propertySet(Bean bean, String propertyName, Object newValue, boolean quiet) {&quot;);</span>
<span class="nc" id="L1178">        insertRegion.add(&quot;\t\t\tswitch (propertyName.hashCode()) {&quot;);</span>
<span class="nc bnc" id="L1179" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc" id="L1180">            insertRegion.addAll(prop.generatePropertySetCase());</span>
<span class="nc" id="L1181">        }</span>
<span class="nc" id="L1182">        insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1183">        insertRegion.add(&quot;\t\t\tsuper.propertySet(bean, propertyName, newValue, quiet);&quot;);</span>
<span class="nc" id="L1184">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1185">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1186">    }</span>

    private void generateMetaValidate() {
<span class="nc bnc" id="L1189" title="All 4 branches missed.">        if (data.isValidated() == false || data.isImmutable()) {</span>
<span class="nc" id="L1190">            return;</span>
        }
<span class="nc" id="L1192">        data.ensureImport(Bean.class);</span>
<span class="nc" id="L1193">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1194">        insertRegion.add(&quot;\t\tprotected void validate(Bean bean) {&quot;);</span>
<span class="nc bnc" id="L1195" title="All 2 branches missed.">        if (data.isValidated()) {</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">            for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L1197" title="All 2 branches missed.">                if (prop.getData().isValidated()) {</span>
<span class="nc" id="L1198">                    insertRegion.add(&quot;\t\t\t&quot; + prop.getData().getValidationMethodName() +</span>
<span class="nc" id="L1199">                            &quot;(((&quot; + data.getTypeWildcard() + &quot;) bean).&quot; + prop.getData().getFieldName() +</span>
<span class="nc" id="L1200">                            &quot;, \&quot;&quot; + prop.getData().getPropertyName() + &quot;\&quot;);&quot;);</span>
                }
<span class="nc" id="L1202">            }</span>
        }
<span class="nc bnc" id="L1204" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L1205">            insertRegion.add(&quot;\t\t\tsuper.validate(bean);&quot;);</span>
        }
<span class="nc" id="L1207">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1208">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1209">    }</span>

    //-----------------------------------------------------------------------
    private void generateBuilderClass() {
<span class="nc bnc" id="L1213" title="All 2 branches missed.">        if (data.isSkipBuilderGeneration()) {</span>
<span class="nc" id="L1214">            return;</span>
        }
<span class="nc" id="L1216">        List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc" id="L1217">        generateSeparator();</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">        String finalType = data.isTypeFinal() ? &quot;final &quot; : &quot;&quot;;</span>
<span class="nc" id="L1219">        insertRegion.add(&quot;\t/**&quot;);</span>
<span class="nc" id="L1220">        insertRegion.add(&quot;\t * The bean-builder for {@code &quot; + data.getTypeRaw() + &quot;}.&quot;);</span>
<span class="nc bnc" id="L1221" title="All 2 branches missed.">        if (data.isTypeGeneric()) {</span>
<span class="nc bnc" id="L1222" title="All 2 branches missed.">            for (int j = 0; j &lt; data.getTypeGenericCount(); j++) {</span>
<span class="nc" id="L1223">                insertRegion.add(&quot;\t * @param &quot; + data.getTypeGenericName(j, true) + &quot;  the type&quot;);</span>
            }
        }
<span class="nc" id="L1226">        insertRegion.add(&quot;\t */&quot;);</span>
        String superBuilder;
<span class="nc bnc" id="L1228" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L1229">            superBuilder = data.getSuperTypeRaw() + &quot;.Builder&quot; + data.getSuperTypeGeneric(true);</span>
<span class="nc bnc" id="L1230" title="All 2 branches missed.">        } else if (data.isEffectiveBuilderScopeVisible()) {</span>
<span class="nc" id="L1231">            data.ensureImport(DirectFieldsBeanBuilder.class);</span>
<span class="nc" id="L1232">            superBuilder = &quot;DirectFieldsBeanBuilder&lt;&quot; + data.getTypeNoExtends() + &quot;&gt;&quot;;</span>
        } else {
<span class="nc" id="L1234">            data.ensureImport(DirectPrivateBeanBuilder.class);</span>
<span class="nc" id="L1235">            superBuilder = &quot;DirectPrivateBeanBuilder&lt;&quot; + data.getTypeNoExtends() + &quot;&gt;&quot;;</span>
        }
<span class="nc bnc" id="L1237" title="All 2 branches missed.">        if (data.isConstructable()) {</span>
<span class="nc" id="L1238">            insertRegion.add(&quot;\t&quot; + data.getEffectiveBuilderScope() + &quot;static &quot; + finalType +</span>
<span class="nc" id="L1239">                    &quot;class Builder&quot; + data.getTypeGeneric(true) + &quot; extends &quot; + superBuilder + &quot; {&quot;);</span>
        } else {
<span class="nc" id="L1241">            insertRegion.add(&quot;\t&quot; + data.getEffectiveBuilderScope() + &quot;abstract static &quot; + finalType +</span>
<span class="nc" id="L1242">                    &quot;class Builder&quot; + data.getTypeGeneric(true) + &quot; extends &quot; + superBuilder + &quot; {&quot;);</span>
        }
<span class="nc bnc" id="L1244" title="All 2 branches missed.">        if (nonDerived.size() &gt; 0) {</span>
<span class="nc" id="L1245">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1246">            generateBuilderProperties();</span>
        }
<span class="nc" id="L1248">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1249">        generateBuilderConstructorNoArgs();</span>
<span class="nc" id="L1250">        generateBuilderConstructorCopy();</span>
<span class="nc" id="L1251">        generateIndentedSeparator();</span>
<span class="nc" id="L1252">        generateBuilderGet();</span>
<span class="nc" id="L1253">        generateBuilderSet();</span>
<span class="nc" id="L1254">        generateBuilderOtherSets();</span>
<span class="nc bnc" id="L1255" title="All 2 branches missed.">        if (data.isConstructable()) {</span>
<span class="nc" id="L1256">            generateBuilderBuild();</span>
        }
<span class="nc" id="L1258">        generateIndentedSeparator();</span>
<span class="nc" id="L1259">        generateBuilderPropertySetMethods();</span>
<span class="nc" id="L1260">        generateIndentedSeparator();</span>
<span class="nc" id="L1261">        generateBuilderToString();</span>
<span class="nc" id="L1262">        insertRegion.add(&quot;\t}&quot;);</span>
<span class="nc" id="L1263">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1264">    }</span>

    private void generateBuilderConstructorNoArgs() {
<span class="nc" id="L1267">        insertRegion.add(&quot;\t\t/**&quot;);</span>
<span class="nc" id="L1268">        insertRegion.add(&quot;\t\t * Restricted constructor.&quot;);</span>
<span class="nc" id="L1269">        insertRegion.add(&quot;\t\t */&quot;);</span>
<span class="nc" id="L1270">        insertRegion.add(&quot;\t\t&quot; + data.getNestedClassConstructorScope() + &quot; Builder() {&quot;);</span>
<span class="nc bnc" id="L1271" title="All 2 branches missed.">        if (data.getImmutableDefaults() != null) {</span>
<span class="nc" id="L1272">            insertRegion.add(&quot;\t\t\t&quot; + data.getImmutableDefaults() + &quot;(this);&quot;);</span>
        }
<span class="nc" id="L1274">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1275">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1276">    }</span>

    private void generateBuilderConstructorCopy() {
<span class="nc bnc" id="L1279" title="All 2 branches missed.">        if (data.isEffectiveBuilderScopeVisible()) {</span>
<span class="nc" id="L1280">            List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc bnc" id="L1281" title="All 2 branches missed.">            if (nonDerived.size() &gt; 0) {</span>
<span class="nc" id="L1282">                insertRegion.add(&quot;\t\t/**&quot;);</span>
<span class="nc" id="L1283">                insertRegion.add(&quot;\t\t * Restricted copy constructor.&quot;);</span>
<span class="nc" id="L1284">                insertRegion.add(&quot;\t\t * @param beanToCopy  the bean to copy from, not null&quot;);</span>
<span class="nc" id="L1285">                insertRegion.add(&quot;\t\t */&quot;);</span>
<span class="nc" id="L1286">                insertRegion.add(&quot;\t\t&quot; + data.getNestedClassConstructorScope() + &quot; Builder(&quot; + data.getTypeNoExtends() + &quot; beanToCopy) {&quot;);</span>
<span class="nc bnc" id="L1287" title="All 2 branches missed.">                if (data.isSubClass()) {</span>
<span class="nc" id="L1288">                    insertRegion.add(&quot;\t\t\tsuper(beanToCopy);&quot;);</span>
                }
<span class="nc bnc" id="L1290" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L1291">                    insertRegion.addAll(nonDerived.get(i).generateBuilderConstructorAssign(&quot;beanToCopy&quot;));</span>
                }
<span class="nc" id="L1293">                insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1294">                insertRegion.add(&quot;&quot;);</span>
            }
        }
<span class="nc" id="L1297">    }</span>

    private void generateBuilderProperties() {
<span class="nc bnc" id="L1300" title="All 2 branches missed.">        for (PropertyGen prop : nonDerivedProperties()) {</span>
<span class="nc" id="L1301">            insertRegion.addAll(prop.generateBuilderField());</span>
<span class="nc" id="L1302">        }</span>
<span class="nc" id="L1303">    }</span>

    private void generateBuilderGet() {
<span class="nc" id="L1306">        List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc" id="L1307">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1308">        insertRegion.add(&quot;\t\tpublic Object get(String propertyName) {&quot;);</span>
<span class="nc bnc" id="L1309" title="All 2 branches missed.">        if (nonDerived.size() &gt; 0) {</span>
<span class="nc" id="L1310">            insertRegion.add(&quot;\t\t\tswitch (propertyName.hashCode()) {&quot;);</span>
<span class="nc bnc" id="L1311" title="All 2 branches missed.">            for (PropertyGen prop : nonDerived) {</span>
<span class="nc" id="L1312">                insertRegion.addAll(prop.generateBuilderFieldGet());</span>
<span class="nc" id="L1313">            }</span>
<span class="nc" id="L1314">            insertRegion.add(&quot;\t\t\t\tdefault:&quot;);</span>
<span class="nc bnc" id="L1315" title="All 2 branches missed.">            if (data.isRootClass()) {</span>
<span class="nc" id="L1316">                data.ensureImport(NoSuchElementException.class);</span>
<span class="nc" id="L1317">                insertRegion.add(&quot;\t\t\t\t\tthrow new NoSuchElementException(\&quot;Unknown property: \&quot; + propertyName);&quot;);</span>
            } else {
<span class="nc" id="L1319">                insertRegion.add(&quot;\t\t\t\t\treturn super.get(propertyName);&quot;);</span>
            }
<span class="nc" id="L1321">            insertRegion.add(&quot;\t\t\t}&quot;);</span>
        } else {
<span class="nc" id="L1323">            data.ensureImport(NoSuchElementException.class);</span>
<span class="nc" id="L1324">            insertRegion.add(&quot;\t\t\tthrow new NoSuchElementException(\&quot;Unknown property: \&quot; + propertyName);&quot;);</span>
        }
<span class="nc" id="L1326">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1327">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1328">    }</span>

    private void generateBuilderSet() {
<span class="nc" id="L1331">        List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc" id="L1332">        boolean generics = data.getProperties().stream()</span>
<span class="nc bnc" id="L1333" title="All 4 branches missed.">                .filter(p -&gt; p.isGeneric() &amp;&amp; p.isGenericWildcardParamType() == false)</span>
<span class="nc" id="L1334">                .findAny()</span>
<span class="nc" id="L1335">                .isPresent();</span>
<span class="nc bnc" id="L1336" title="All 2 branches missed.">        if (generics) {</span>
<span class="nc" id="L1337">            insertRegion.add(&quot;\t\t@SuppressWarnings(\&quot;unchecked\&quot;)&quot;);</span>
        }
<span class="nc" id="L1339">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1340">        insertRegion.add(&quot;\t\tpublic Builder&quot; + data.getTypeGenericName(true) + &quot; set(String propertyName, Object newValue) {&quot;);</span>
<span class="nc bnc" id="L1341" title="All 2 branches missed.">        if (nonDerived.size() &gt; 0) {</span>
<span class="nc" id="L1342">            insertRegion.add(&quot;\t\t\tswitch (propertyName.hashCode()) {&quot;);</span>
<span class="nc bnc" id="L1343" title="All 2 branches missed.">            for (PropertyGen prop : nonDerived) {</span>
<span class="nc" id="L1344">                insertRegion.addAll(prop.generateBuilderFieldSet());</span>
<span class="nc" id="L1345">            }</span>
<span class="nc" id="L1346">            insertRegion.add(&quot;\t\t\t\tdefault:&quot;);</span>
<span class="nc bnc" id="L1347" title="All 2 branches missed.">            if (data.isRootClass()) {</span>
<span class="nc" id="L1348">                data.ensureImport(NoSuchElementException.class);</span>
<span class="nc" id="L1349">                insertRegion.add(&quot;\t\t\t\t\tthrow new NoSuchElementException(\&quot;Unknown property: \&quot; + propertyName);&quot;);</span>
            } else {
<span class="nc" id="L1351">                insertRegion.add(&quot;\t\t\t\t\tsuper.set(propertyName, newValue);&quot;);</span>
<span class="nc" id="L1352">                insertRegion.add(&quot;\t\t\t\t\tbreak;&quot;);</span>
            }
<span class="nc" id="L1354">            insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1355">            insertRegion.add(&quot;\t\t\treturn this;&quot;);</span>
        } else {
<span class="nc" id="L1357">            data.ensureImport(NoSuchElementException.class);</span>
<span class="nc" id="L1358">            insertRegion.add(&quot;\t\t\tthrow new NoSuchElementException(\&quot;Unknown property: \&quot; + propertyName);&quot;);</span>
        }
<span class="nc" id="L1360">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1361">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1362">    }</span>

    private void generateBuilderOtherSets() {
<span class="nc bnc" id="L1365" title="All 2 branches missed.">        if (data.isEffectiveBuilderScopeVisible()) {</span>
<span class="nc" id="L1366">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1367">            insertRegion.add(&quot;\t\tpublic Builder&quot; + data.getTypeGenericName(true) + &quot; set(MetaProperty&lt;?&gt; property, Object value) {&quot;);</span>
<span class="nc" id="L1368">            insertRegion.add(&quot;\t\t\tsuper.set(property, value);&quot;);</span>
<span class="nc" id="L1369">            insertRegion.add(&quot;\t\t\treturn this;&quot;);</span>
<span class="nc" id="L1370">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1371">            insertRegion.add(&quot;&quot;);</span>
        }
<span class="nc" id="L1373">    }</span>

    private void generateBuilderBuild() {
<span class="nc" id="L1376">        List&lt;PropertyGen&gt; nonDerived = nonDerivedProperties();</span>
<span class="nc" id="L1377">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1378">        insertRegion.add(&quot;\t\tpublic &quot; + data.getTypeRaw() + data.getTypeGenericName(true) + &quot; build() {&quot;);</span>
<span class="nc bnc" id="L1379" title="All 2 branches missed.">        if (data.getImmutablePreBuild() != null) {</span>
<span class="nc" id="L1380">            insertRegion.add(&quot;\t\t\t&quot; + data.getImmutablePreBuild() + &quot;(this);&quot;);</span>
        }
<span class="nc bnc" id="L1382" title="All 2 branches missed.">        if (data.getConstructorStyle() == CONSTRUCTOR_BY_ARGS) {</span>
<span class="nc bnc" id="L1383" title="All 2 branches missed.">            if (nonDerived.size() == 0) {</span>
<span class="nc" id="L1384">                insertRegion.add(&quot;\t\t\treturn new &quot; + data.getTypeWithDiamond() + &quot;();&quot;);</span>
            } else {
<span class="nc" id="L1386">                insertRegion.add(&quot;\t\t\treturn new &quot; + data.getTypeWithDiamond() + &quot;(&quot;);</span>
<span class="nc bnc" id="L1387" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc bnc" id="L1388" title="All 2 branches missed.">                    insertRegion.add(&quot;\t\t\t\t\t&quot; + nonDerived.get(i).generateBuilderFieldName() + (i &lt; nonDerived.size() - 1 ? &quot;,&quot; : &quot;);&quot;));</span>
                }
            }
<span class="nc bnc" id="L1391" title="All 2 branches missed.">        } else if (data.getConstructorStyle() == CONSTRUCTOR_BY_BUILDER) {</span>
<span class="nc" id="L1392">            insertRegion.add(&quot;\t\t\treturn new &quot; + data.getTypeWithDiamond() + &quot;(this);&quot;);</span>
        }
<span class="nc" id="L1394">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1395">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1396">    }</span>

    private void generateBuilderPropertySetMethods() {
<span class="nc bnc" id="L1399" title="All 2 branches missed.">        if (data.isEffectiveBuilderScopeVisible()) {</span>
<span class="nc bnc" id="L1400" title="All 2 branches missed.">            for (PropertyGen prop : nonDerivedProperties()) {</span>
<span class="nc" id="L1401">                insertRegion.addAll(prop.generateBuilderSetMethod());</span>
<span class="nc" id="L1402">            }</span>
        }
<span class="nc" id="L1404">    }</span>

    private void generateBuilderToString() {
<span class="nc" id="L1407">        List&lt;PropertyGen&gt; nonDerived = toStringProperties();</span>
<span class="nc bnc" id="L1408" title="All 4 branches missed.">        if (data.isImmutable() &amp;&amp; data.isTypeFinal()) {</span>
<span class="nc" id="L1409">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1410">            insertRegion.add(&quot;\t\tpublic String toString() {&quot;);</span>
<span class="nc bnc" id="L1411" title="All 2 branches missed.">            if (nonDerived.size() == 0) {</span>
<span class="nc" id="L1412">                insertRegion.add(&quot;\t\t\treturn \&quot;&quot; + data.getTypeRaw() + &quot;.Builder{}\&quot;;&quot;);</span>
            } else {
<span class="nc" id="L1414">                insertRegion.add(&quot;\t\t\tStringBuilder buf = new StringBuilder(&quot; + (nonDerived.size() * 32 + 32) + &quot;);&quot;);</span>
<span class="nc" id="L1415">                insertRegion.add(&quot;\t\t\tbuf.append(\&quot;&quot; + data.getTypeRaw() + &quot;.Builder{\&quot;);&quot;);</span>
<span class="nc bnc" id="L1416" title="All 2 branches missed.">                for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L1417">                    PropertyGen prop = nonDerived.get(i);</span>
<span class="nc" id="L1418">                    String getter = nonDerived.get(i).generateBuilderFieldName();</span>
<span class="nc" id="L1419">                    data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L1420">                    String base = &quot;\t\t\tbuf.append(\&quot;&quot; + prop.getData().getPropertyName() +</span>
                            &quot;\&quot;).append('=').append(JodaBeanUtils.toString(&quot; + getter + &quot;))&quot;;
<span class="nc bnc" id="L1422" title="All 2 branches missed.">                    if (i &lt; nonDerived.size() - 1) {</span>
<span class="nc" id="L1423">                        insertRegion.add(base + &quot;.append(',').append(' ');&quot;);</span>
                    } else {
<span class="nc" id="L1425">                        insertRegion.add(base + &quot;;&quot;);</span>
                    }
                }
<span class="nc" id="L1428">                insertRegion.add(&quot;\t\t\tbuf.append('}');&quot;);</span>
<span class="nc" id="L1429">                insertRegion.add(&quot;\t\t\treturn buf.toString();&quot;);</span>
            }
<span class="nc" id="L1431">            insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1432">            insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1433">            return;</span>
        }
        
<span class="nc" id="L1436">        insertRegion.add(&quot;\t\t@Override&quot;);</span>
<span class="nc" id="L1437">        insertRegion.add(&quot;\t\tpublic String toString() {&quot;);</span>
<span class="nc" id="L1438">        insertRegion.add(&quot;\t\t\tStringBuilder buf = new StringBuilder(&quot; + (nonDerived.size() * 32 + 32) + &quot;);&quot;);</span>
<span class="nc" id="L1439">        insertRegion.add(&quot;\t\t\tbuf.append(\&quot;&quot; + data.getTypeRaw() + &quot;.Builder{\&quot;);&quot;);</span>
<span class="nc" id="L1440">        insertRegion.add(&quot;\t\t\tint len = buf.length();&quot;);</span>
<span class="nc" id="L1441">        insertRegion.add(&quot;\t\t\ttoString(buf);&quot;);</span>
<span class="nc" id="L1442">        insertRegion.add(&quot;\t\t\tif (buf.length() &gt; len) {&quot;);</span>
<span class="nc" id="L1443">        insertRegion.add(&quot;\t\t\t\tbuf.setLength(buf.length() - 2);&quot;);</span>
<span class="nc" id="L1444">        insertRegion.add(&quot;\t\t\t}&quot;);</span>
<span class="nc" id="L1445">        insertRegion.add(&quot;\t\t\tbuf.append('}');&quot;);</span>
<span class="nc" id="L1446">        insertRegion.add(&quot;\t\t\treturn buf.toString();&quot;);</span>
<span class="nc" id="L1447">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1448">        insertRegion.add(&quot;&quot;);</span>
        
<span class="nc bnc" id="L1450" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L1451">            insertRegion.add(&quot;\t\t@Override&quot;);</span>
        }
<span class="nc" id="L1453">        insertRegion.add(&quot;\t\tprotected void toString(StringBuilder buf) {&quot;);</span>
<span class="nc bnc" id="L1454" title="All 2 branches missed.">        if (data.isSubClass()) {</span>
<span class="nc" id="L1455">            insertRegion.add(&quot;\t\t\tsuper.toString(buf);&quot;);</span>
        }
<span class="nc bnc" id="L1457" title="All 2 branches missed.">        for (int i = 0; i &lt; nonDerived.size(); i++) {</span>
<span class="nc" id="L1458">            PropertyGen prop = nonDerived.get(i);</span>
<span class="nc" id="L1459">            String getter = nonDerived.get(i).generateBuilderFieldName();</span>
<span class="nc" id="L1460">            data.ensureImport(JodaBeanUtils.class);</span>
<span class="nc" id="L1461">            insertRegion.add(&quot;\t\t\tbuf.append(\&quot;&quot; + prop.getData().getPropertyName() +</span>
                    &quot;\&quot;).append('=').append(JodaBeanUtils.toString(&quot; + getter + &quot;)).append(',').append(' ');&quot;);
        }
<span class="nc" id="L1464">        insertRegion.add(&quot;\t\t}&quot;);</span>
<span class="nc" id="L1465">        insertRegion.add(&quot;&quot;);</span>
<span class="nc" id="L1466">    }</span>

    //-----------------------------------------------------------------------
    boolean isBean() {
<span class="nc bnc" id="L1470" title="All 2 branches missed.">        return properties != null;</span>
    }

    BeanData getData() {
<span class="nc" id="L1474">        return data;</span>
    }

    BeanGenConfig getConfig() {
<span class="nc" id="L1478">        return config;</span>
    }

    File getFile() {
<span class="nc" id="L1482">        return file;</span>
    }

    String getFieldPrefix() {
<span class="nc" id="L1486">        return config.getPrefix();</span>
    }

    private List&lt;PropertyGen&gt; nonDerivedProperties() {
<span class="nc" id="L1490">        List&lt;PropertyGen&gt; nonDerived = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1491" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L1492" title="All 2 branches missed.">            if (prop.getData().isDerived() == false) {</span>
<span class="nc" id="L1493">                nonDerived.add(prop);</span>
            }
<span class="nc" id="L1495">        }</span>
<span class="nc" id="L1496">        return nonDerived;</span>
    }

    private List&lt;PropertyGen&gt; nonDerivedEqualsHashCodeProperties() {
<span class="nc" id="L1500">        List&lt;PropertyGen&gt; nonDerived = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1501" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L1502" title="All 4 branches missed.">            if (!prop.getData().isDerived() &amp;&amp; !prop.getData().getEqualsHashCodeStyle().equals(&quot;omit&quot;)) {</span>
<span class="nc" id="L1503">                nonDerived.add(prop);</span>
            }
<span class="nc" id="L1505">        }</span>
<span class="nc" id="L1506">        return nonDerived;</span>
    }

    private List&lt;PropertyGen&gt; toStringProperties() {
<span class="nc" id="L1510">        List&lt;PropertyGen&gt; props = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1511" title="All 2 branches missed.">        for (PropertyGen prop : properties) {</span>
<span class="nc bnc" id="L1512" title="All 4 branches missed.">            if (!prop.getData().isDerived() &amp;&amp; !&quot;omit&quot;.equals(prop.getData().getToStringStyle())) {</span>
<span class="nc" id="L1513">                props.add(prop);</span>
            }
<span class="nc" id="L1515">        }</span>
<span class="nc" id="L1516">        return props;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>